<!doctype html>
<html lang="zh-CN" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="çŸ¥é Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="çŸ¥é Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6PSESJX0BM"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-6PSESJX0BM",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="çŸ¥é" href="/opensearch.xml">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?135f3e7db7162b348a790b8b00e07413",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="IXU12YQUjF">
<script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",t.defer=!0;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script>
<script data-ad-client="ca-pub-3487507367729662" defer="defer" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script>
<script>window.OneSignal=window.OneSignal||[],OneSignal.push((function(){OneSignal.init({appId:"6391e77e-13e2-440e-aea0-fe760113a4d3",notifyButton:{enable:!0}})}))</script>
<link rel="alternate" type="application/rss+xml" href="/lifestyle/rss.xml" title="çŸ¥é Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/lifestyle/atom.xml" title="çŸ¥é Blog Atom Feed">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link rel="stylesheet" href="/katex/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<link rel="stylesheet" href="https://fonts.font.im/css?family=Raleway:500,700&amp;display=swap"><title data-react-helmet="true">å®ç°å‰ç«¯ç½‘é¡µ WebRTC è§†é¢‘é€šè¯ä»¥åŠæ¢è„¸ç‰¹æ•ˆ - çŸ¥é</title><meta data-react-helmet="true" property="og:title" content="å®ç°å‰ç«¯ç½‘é¡µ WebRTC è§†é¢‘é€šè¯ä»¥åŠæ¢è„¸ç‰¹æ•ˆ - çŸ¥é"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="description" content="å› ä¸ºç–«æƒ…çš„åŸå› ï¼Œçº¿ä¸Šè§†é¢‘ä¼šè®®è½¯ä»¶å¼‚å†›çªèµ·ï¼Œæˆä¸ºäº†åœ¨å®¶åŠå…¬çš„ä¸»è¦æ²Ÿé€šæ¸ é“ã€‚è€Œæœ€è¿‘æŠ–éŸ³ä¸Šâ€œèš‚èšå‘€å˜¿â€æ¶ææ¢è„¸çš„å°è§†é¢‘ä¹Ÿçªç„¶ç«äº†èµ·æ¥ï¼Œé‚£æˆ‘å°±æƒ³äº†æƒ³èƒ½ä¸èƒ½åœ¨è§†é¢‘ä¼šè®®çš„æ—¶å€™æ¢å¼ è„¸æ´»è·ƒä¸‹æ°”æ°›ï¼Ÿ"><meta data-react-helmet="true" property="og:description" content="å› ä¸ºç–«æƒ…çš„åŸå› ï¼Œçº¿ä¸Šè§†é¢‘ä¼šè®®è½¯ä»¶å¼‚å†›çªèµ·ï¼Œæˆä¸ºäº†åœ¨å®¶åŠå…¬çš„ä¸»è¦æ²Ÿé€šæ¸ é“ã€‚è€Œæœ€è¿‘æŠ–éŸ³ä¸Šâ€œèš‚èšå‘€å˜¿â€æ¶ææ¢è„¸çš„å°è§†é¢‘ä¹Ÿçªç„¶ç«äº†èµ·æ¥ï¼Œé‚£æˆ‘å°±æƒ³äº†æƒ³èƒ½ä¸èƒ½åœ¨è§†é¢‘ä¼šè®®çš„æ—¶å€™æ¢å¼ è„¸æ´»è·ƒä¸‹æ°”æ°›ï¼Ÿ"><meta data-react-helmet="true" property="og:image" content="https://qzyzz.github.io/img/logo.png"><meta data-react-helmet="true" name="twitter:image" content="https://qzyzz.github.io/img/logo.png"><meta data-react-helmet="true" property="og:url" content="https://qzyzz.github.io/webrtc-avatarify-face-swap-tutorial"><meta data-react-helmet="true" name="docsearch:language" content="zh-CN"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo.png"><link data-react-helmet="true" rel="canonical" href="https://qzyzz.github.io/webrtc-avatarify-face-swap-tutorial"><link data-react-helmet="true" rel="alternate" href="https://qzyzz.github.io/webrtc-avatarify-face-swap-tutorial" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://qzyzz.github.io/en/webrtc-avatarify-face-swap-tutorial" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://qzyzz.github.io/webrtc-avatarify-face-swap-tutorial" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://PIC6T7CXE0-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.e9f687ee.css">
<link rel="preload" href="/assets/js/runtime~main.66196b93.js" as="script">
<link rel="preload" href="/assets/js/main.0b32cb3b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">è·³åˆ°ä¸»è¦å†…å®¹ä½ç½®</a></div><div class="announcementBar_3WsW" role="banner"><div class="announcementBarContent_3EUC announcementBarCloseable_3myR"><a href="/vue3-basics">Vue3åŸºç¡€å…¥é—¨æ•™ç¨‹(å«setupè¯­æ³•ç³–)</a></div><button type="button" class="announcementBarClose_38nx clean-btn" aria-label="å…³é—­"><span aria-hidden="true">Ã—</span></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="çŸ¥é" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.png" alt="çŸ¥é" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">çŸ¥é</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">é¦–é¡µ</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tags">æ ‡ç­¾</a></li><li><a class="dropdown__link" href="/lifestyle">éšç¬”</a></li><li><a class="dropdown__link" href="/tags/èŒä¸š">èŒä¸š</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">å­¦ä¹ </a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/videos/">æŠ€æœ¯è§†é¢‘</a></li><li><a class="dropdown__link" href="/docs/css/css-tutorial-intro">CSS å®Œå…¨æŒ‡å—</a></li><li><a class="dropdown__link" href="/docs/resources/">èµ„æºå¯¼èˆª</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/tools/">å°å·¥å…·</a><a href="https://github.com/qzyzz/Blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>æºç <svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢</span></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="çŸ¥é" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.png" alt="çŸ¥é" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">çŸ¥é</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">é¦–é¡µ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/tags">æ ‡ç­¾</a></li><li class="menu__list-item"><a class="menu__link" href="/lifestyle">éšç¬”</a></li><li class="menu__list-item"><a class="menu__link" href="/tags/èŒä¸š">èŒä¸š</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">å­¦ä¹ </a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/videos/">æŠ€æœ¯è§†é¢‘</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/css/css-tutorial-intro">CSS å®Œå…¨æŒ‡å—</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/resources/">èµ„æºå¯¼èˆª</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/tools/">å°å·¥å…·</a></li><li class="menu__list-item"><a href="https://github.com/qzyzz/Blog" target="_blank" rel="noopener noreferrer" class="menu__link"><span>æºç <svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">è¿‘æœŸæ–‡ç« </div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/vue3-basics">vue3åŸºç¡€</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/first-blog">ç¬¬ä¸€ç¯‡åšå®¢</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/how-to-learn-a-programming-language-quickly">å¦‚ä½•å¿«é€Ÿå­¦ä¼šä¸€é—¨ç¼–ç¨‹è¯­è¨€</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/css-is-pseudo-class-selector">CSS :is() ä¼ªç±»é€‰æ‹©å™¨ä½¿ç”¨æŒ‡å—</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/interview-failed-recover">é¢è¯•æ²¡é€šè¿‡ï¼Œåˆä¸€æ¬¡ï¼Œæˆ‘å¥½èœå‘€...</a></li></ul></nav></aside><main class="col col--7"><div class="sc-AxirZ ddyydL"><div class="row" style="margin:0"><div class="col col--12 article__details"><article><header><h1 class="margin-bottom--md blogPostTitle_nmLu text--center">å®ç°å‰ç«¯ç½‘é¡µ WebRTC è§†é¢‘é€šè¯ä»¥åŠæ¢è„¸ç‰¹æ•ˆ</h1></header><p class="single-post--date text--center">2021å¹´3æœˆ Â· é¢„è®¡é˜…è¯»æ—¶é—´ï¼š 8 åˆ†é’Ÿ</p><div class="text--center margin-bottom--xs padding-bottom--xs"><div class="post__tags-container margin-top--none margin-bottom--md"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="tags" class="svg-inline--fa fa-tags fa-w-20 margin-right--md" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" style="font-size:1.25rem" color="#c4d3e0"><path fill="currentColor" d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"></path></svg><a class="post__tags margin-right--sm" style="font-size:0.75em;font-weight:500" href="/tags/å‰ç«¯">å‰ç«¯</a><a class="post__tags margin-horiz--sm" style="font-size:0.75em;font-weight:500" href="/tags/web-rtc">WebRTC</a><a class="post__tags margin-horiz--sm" style="font-size:0.75em;font-weight:500" href="/tags/avatarify">avatarify</a></div></div><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3487507367729662" data-ad-slot="2800800187" data-ad-format="auto" data-full-width-responsive="true"></ins><section class="sc-AxjAm bFgQpc markdown"><p>å› ä¸ºç–«æƒ…çš„åŸå› ï¼Œçº¿ä¸Šè§†é¢‘ä¼šè®®è½¯ä»¶å¼‚å†›çªèµ·ï¼Œæˆä¸ºäº†åœ¨å®¶åŠå…¬çš„ä¸»è¦æ²Ÿé€šæ¸ é“ã€‚è€Œæœ€è¿‘æŠ–éŸ³ä¸Šâ€œèš‚èšå‘€å˜¿â€æ¶ææ¢è„¸çš„å°è§†é¢‘ä¹Ÿçªç„¶ç«äº†èµ·æ¥ï¼Œé‚£æˆ‘å°±æƒ³äº†æƒ³èƒ½ä¸èƒ½åœ¨è§†é¢‘ä¼šè®®çš„æ—¶å€™æ¢å¼ è„¸æ´»è·ƒä¸‹æ°”æ°›ï¼Ÿåœ¨ Github ä¸Šä¸€ç•ªæœå¯»ä¹‹åå‘ç°è¿˜çœŸæœ‰åŠæ³•ï¼Œæœ‰ä¸€ä¸ªå¼€æºçš„ Python äººå·¥æ™ºèƒ½æ¢è„¸çš„åº“ï¼Œé‚£æ­£å¥½è¶ç€è¿™ä¸ªæœºä¼šç ”ç©¶ä¸€ä¸‹å‰ç«¯ WebRTC å®ç°è§†é¢‘é€šè¯åŠŸèƒ½ï¼Œå¤–åŠ æ¢è„¸æ“ä½œã€‚å…ˆçœ‹ä¸€ä¸‹æ•ˆæœå§ï¼š</p><video autoplay="" loop="" muted="" playsinline=""><source src="/assets/medias/webrtc-avatarify-face-swap-demo-2b84596fe5a574818101731a5b2610ec.mp4" type="video/mp4"></video><p>å› ä¸ºæœ‰æ¶‰åŠåˆ°ä¸€ç‚¹ç‚¹çš„åå°ï¼Œæ‰€ä»¥é¡¹ç›®åˆ†æˆäº†ä¸¤éƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯ç”¨äºå­˜æ”¾å‰ç«¯ä»£ç çš„ frontend é¡¹ç›®å’Œå­˜æ”¾åç«¯ä»£ç çš„ backend é¡¹ç›®ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">é¡¹ç›®æ ¹ç›®å½•</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">-- backend</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">-- frontend</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å¦å¤–è¿™ä¸ªè§†é¢‘éœ€è¦ç”µè„‘ä¸Šæœ‰æ‘„åƒå¤´ï¼Œæ²¡æœ‰çš„è¯å¯ä»¥æƒ³åŠæ³•æŠŠæ‰‹æœºå½“ä½œç”µè„‘çš„æ‘„åƒå¤´ã€‚</p><p><strong>æ³¨æ„ï¼šæœ¬æ•™ç¨‹ä¸­çš„ä»£ç ä»…ä¾›å±•ç¤º AI æ¢è„¸æŠ€æœ¯çš„åº”ç”¨ï¼Œä¸å¯ä»¥ç”¨äºè·å–å…¶ä»–äººéšç§æˆ–å…¶ä»–ä»»ä½•éæ³•ç›®çš„ã€‚</strong></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç¼–å†™é¡µé¢"></a>ç¼–å†™é¡µé¢<a class="hash-link" href="#ç¼–å†™é¡µé¢" title="Direct link to heading">#</a></h2><p>å› ä¸ºæ˜¯å‰ç«¯å®ç°ï¼Œé¦–å…ˆè‚¯å®šæ˜¯ç¼–å†™é¡µé¢ã€‚è¿™ä¸ªé¡µé¢æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯ä¸€ä¸ªè§†é¢‘ç»„ä»¶ã€æ˜¾ç¤ºç”¨æˆ· ID çš„æ–‡æœ¬ã€å‘¼å«å¯¹æ–¹è§†é¢‘çš„è¾“å…¥æ¡†å’ŒæŒ‰é’®ï¼Œè§†é¢‘ç»„ä»¶é»˜è®¤æ˜¾ç¤ºè‡ªå·±çš„è§†é¢‘ï¼Œå½“è§†é¢‘æ¥é€šä¹‹åå°±ä¼šæ˜¾ç¤ºå¯¹æ–¹çš„è§†é¢‘ï¼Œè€Œè‡ªå·±çš„è§†é¢‘ä¼šç¼©å°åˆ°å³ä¸Šè§’ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="html"></a>HTML<a class="hash-link" href="#html" title="Direct link to heading">#</a></h3><p>åœ¨ frontend ç›®å½•ä¸‹æ–°å»º index.htmlã€style.css å’Œ index.js æ–‡ä»¶ã€‚é¦–å…ˆçœ‹ä¸€ä¸‹ HTML ç»“æ„ï¼Œindex.html ä¸­ä¸»è¦çš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- frontend/index.html --&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- å…¶ä»–ä»£ç  --&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">link</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">rel</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">stylesheet</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">style.css</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">main</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">container</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">videos</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">video</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">myVideo</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">videoSize</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">autoplay</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">video</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">video</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">peerVideo</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">videoSize</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">autoplay</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">video</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">idText</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">call</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">input</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">peerIdInput</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">placeholder</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">è¯·è¾“å…¥å¯¹æ–¹ id</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">button</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">joinBtn</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">è§†é¢‘é€šè¯</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">button</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">main</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">index.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>æ¯ä¸ªæ ‡ç­¾çš„ä½œç”¨æ˜¯ï¼š</p><ul><li><code>&lt;main /&gt;</code>Â  ç”¨äºè®¾ç½®é¡µé¢èƒŒæ™¯ï¼ŒæŠŠæ‰€æœ‰ç»„ä»¶å±…ä¸­å¯¹é½ã€‚</li><li><code>&lt;div class=&quot;videos&quot;&gt;</code>Â  é‡Œè¾¹åˆ†åˆ«æ”¾äº†æ˜¾ç¤ºè‡ªå·±è§†é¢‘ <code>#myVideo</code>Â  å’Œå¯¹æ–¹è§†é¢‘ <code>#peerVideo</code>Â  çš„ <code>&lt;video /&gt;</code>Â  ç»„ä»¶ï¼Œå¹¶è®¾ç½®ä¸ºè‡ªåŠ¨æ’­æ”¾ï¼Œä»¥ä¾¿äºåœ¨åŠ è½½æ‘„åƒå¤´åç«‹åˆ»å¼€å§‹æ’­æ”¾ç”»é¢ã€‚</li><li><code>&lt;p id=&quot;idText&quot;&gt;</code> åœ¨é¡µé¢æ‰“å¼€æ—¶æ˜¾ç¤ºè‡ªå·±çš„ç”¨æˆ· IDï¼Œç›¸å½“äºæ˜¯ç”µè¯å·ç ã€‚</li><li><code>&lt;div class=&quot;call&quot;&gt;</code>Â  é‡Œæ˜¯è¾“å…¥å¯¹æ–¹ ID çš„æ–‡æœ¬æ¡† <code>#peerIdInput</code>Â  å’Œå‘¼å«æŒ‰é’® <code>#joinBtn</code>Â ã€‚</li><li>æœ€ååœ¨ <code>&lt;head /&gt;</code>Â  ä¸­å¼•å…¥æ ·å¼æ–‡ä»¶ style.cssï¼Œåœ¨ <code>&lt;body /&gt;</code>Â  ç»“æŸå‰å¼•å…¥ index.jsã€‚æˆ‘ä»¬å°†ä¸»è¦åœ¨ index.js ä¸­ç¼–å†™ä»£ç ã€‚</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="css"></a>CSS<a class="hash-link" href="#css" title="Direct link to heading">#</a></h3><p>css çš„ä»£ç éƒ½æ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬å°±æ˜¯è®¾ç½®ä¸€ä¸‹æ ·å¼ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹é‡è¦çš„éƒ¨åˆ†ï¼Œå‰©ä½™çš„å¯ä»¥åœ¨æºä»£ç ä¸­æŸ¥çœ‹ã€‚å› ä¸ºè‡ªå·±çš„è§†é¢‘è¦åœ¨è§†é¢‘æ¥é€šæ—¶ç§»åŠ¨åˆ°å³ä¸Šè§’ï¼Œé‚£ä¹ˆå°±éœ€è¦æŠŠ <code>&lt;div class=&quot;videos&quot;&gt; </code> å®¹å™¨è®¾ç½®ä¸ºç›¸å¯¹å®šä½ï¼ŒæŠŠæˆ‘çš„è§†é¢‘å’Œå¯¹æ–¹çš„è§†é¢‘è®¾ç½®æˆä¸€æ ·çš„å®½é«˜ï¼Œç„¶åå…ˆéšè—å¯¹æ–¹è§†é¢‘ï¼Œå½“è§†é¢‘æ¥é€šæ—¶ï¼Œåˆ©ç”¨ JavaScript åŠ ä¸Šæ¥é€šåï¼Œæˆ‘çš„è§†é¢‘çš„æ ·å¼ï¼ŒæŠŠæˆ‘çš„è§†é¢‘è®¾ç½®ä¸ºç»å¯¹å®šä½ï¼Œå®½é«˜è°ƒå°ï¼Œæ”¾åˆ°å³ä¸Šè§’ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly css"><pre tabindex="0" class="prism-code language-css codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/* frontend/style.css */</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token selector" style="color:#00009f">videos</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">position</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> relative</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token selector class" style="color:#00009f">.videoSize</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">width</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token unit">px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">height</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token unit">px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">object-fit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cover</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* è®©è§†é¢‘æŒ‰æ¯”ä¾‹å æ»¡æ•´ä¸ªç©ºé—´ */</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token selector class" style="color:#00009f">.rightTop</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/* ä»¥ä¸‹æ˜¯é€šè¯ä¸­çš„æ ·å¼ */</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">position</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> absolute</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">width</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">150</span><span class="token unit">px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">height</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token unit">px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">right</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">top</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token selector id" style="color:#00009f">#peerVideo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">display</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> none</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å…¶ä»–ç»„ä»¶åŸºæœ¬åªæ˜¯è®¾ç½®äº†ä¸‹ Grid å¸ƒå±€ã€å®½é«˜ã€å¤§å°ã€é˜´å½±ã€èƒŒæ™¯ã€å­—ä½“ï¼Œæ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„ï¼Œå¯ä»¥ç›´æ¥æŸ¥çœ‹æºä»£ç ã€‚æ ·å¼ä¸­æ‰€ç”¨åˆ°çš„å›¾æ ‡åœ¨ <code>frontend/icons</code>Â  ç›®å½•ä¸‹ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="è®¿é—®æ‘„åƒå¤´"></a>è®¿é—®æ‘„åƒå¤´<a class="hash-link" href="#è®¿é—®æ‘„åƒå¤´" title="Direct link to heading">#</a></h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬å…ˆç†Ÿæ‚‰ä¸€ä¸‹è®¿é—®æ‘„åƒå¤´çš„ä»£ç ã€‚åœ¨ JavaScript ä¸­è®¿é—®ç”¨æˆ·çš„æ‘„åƒå¤´ä¸»è¦ä½¿ç”¨ <code>navigator.mediaDevices.getUserMedia()</code> æ–¹æ³•ï¼ŒÂ  å®ƒæ¥æ”¶ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œç”¨äºæŒ‡å®šè¦è·å–çš„è®¾å¤‡ï¼Œä¾‹å¦‚è§†é¢‘æˆ–éŸ³é¢‘ï¼Œç„¶åè¿”å›ä¸€ä¸ª Promiseï¼Œåœ¨ Promise å®Œæˆä¹‹åå®ƒä¼šä¼ é€’ç»™æˆ‘ä»¬ä¸€ä¸ª Stream æµï¼Œæˆ‘ä»¬æŠŠå®ƒæ”¾åˆ° <code>&lt;video /&gt;</code>Â  æ ‡ç­¾çš„ <code>srcObject</code>Â  å±æ€§ä¸­å°±å¯ä»¥äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿä»£ç å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// frontend/index.js</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> myVideo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementById</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;myVideo&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">navigator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mediaDevices</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getUserMedia</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> video</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> audio</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">stream</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    myVideo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">srcObject</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> stream</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼š</p><ul><li>è·å–äº† <code>#myVideo</code>Â  è¿™ä¸ª <code>&lt;video /&gt;</code>Â  ç»„ä»¶ã€‚</li><li>ä½¿ç”¨ <code>navigator.mediaDevices.getUserMedia()</code> å¹¶ç»™å®ƒä¼ é€’äº†ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡çš„ video å’Œ audio å±æ€§éƒ½è®¾ç½®ä¸ºäº† trueï¼Œè¡¨ç¤ºè¦è®¿é—®æ‘„åƒå¤´å’ŒéŸ³é¢‘è®¾å¤‡ã€‚</li></ul><p>è¿™æ—¶ï¼Œä½¿ç”¨ VS Code çš„ Live Server æ’ä»¶è¿è¡Œé¡¹ç›®ï¼ˆæ²¡æœ‰çš„è¯å®‰è£…ä¸€ä¸‹ï¼Œå¾ˆç®€å•ï¼‰ï¼Œåœ¨ index.html æ–‡ä»¶é‡Œå³å‡»ï¼Œé€‰æ‹© Open with Live Serverï¼Œæ‰“å¼€ä¹‹åï¼Œæµè§ˆå™¨å¯èƒ½ä¼šæç¤ºæ­¤ç½‘ç«™éœ€è¦è®¿é—®æ‘„åƒå¤´å’ŒéŸ³é¢‘è®¾å¤‡ï¼Œç‚¹å‡»å…è®¸ï¼Œå°±èƒ½çœ‹åˆ°è‡ªå·±çš„è§†é¢‘äº†ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç¼–å†™åå°"></a>ç¼–å†™åå°<a class="hash-link" href="#ç¼–å†™åå°" title="Direct link to heading">#</a></h2><p>è¦å®ç°è§†é¢‘é€šè¯ï¼Œéœ€è¦ä½¿ç”¨ WebRTC æŠ€æœ¯ï¼Œè¿™ä¸ªæŠ€æœ¯ç‰µæ‰¯çš„æ¦‚å¿µå’Œ API è¿‡äºåºå¤§å’Œå¤æ‚ï¼Œä¸è¿‡æœ‰å¼€æºçš„åº“æ¥å¸®æˆ‘ä»¬ç®€åŒ–äº† WebRTC çš„æ“ä½œï¼Œè¿™é‡Œä½¿ç”¨ä¸€ä¸ªå«åš Peer.js çš„åº“ï¼Œå®ƒå°è£…äº† WebRTC æ‚ä¹±çš„ APIï¼Œæä¾›äº†å®Œæ•´çš„ã€å¯é…ç½®çš„ã€æ˜“äºä½¿ç”¨çš„ APIã€‚
<a href="https://peerjs.com/" target="_blank" rel="noopener noreferrer">https://peerjs.com/</a>
æˆ‘ä»¬å°†ä¼šé€šè¿‡æŠŠ Peer é™„åŠ åˆ° Express.js æœåŠ¡å™¨ä¸Šï¼Œæ¥ç”Ÿæˆç”¨æˆ· ID å¹¶ç®¡ç† WebRTC è¿æ¥ã€‚é¦–å…ˆåœ¨ backend ç›®å½•ä¸‹è¿è¡Œï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> init -y</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># æˆ–</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> init -y</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>æ¥ç€åˆå§‹åŒ–ä¸€ä¸ª node.js é¡¹ç›®ï¼Œä½¿ç”¨ npm æˆ– yarn å®‰è£… peer å’Œ express ä¾èµ–ï¼Œå› ä¸ºæƒ³åœ¨æ”¹åŠ¨ä»£ç æ—¶è‡ªåŠ¨é‡å¯æœåŠ¡ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å†å®‰è£…ä¸€ä¸ª nodemon ä¾èµ–ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> peer express nodemon</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># æˆ–</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> --save peer express nodemon</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å®‰è£…å®Œæˆä¹‹åæ–°å»ºä¸€ä¸ª server.js æ–‡ä»¶ï¼Œæ•´ä¸ªåå°æœåŠ¡æˆ‘ä»¬å°±åªéœ€è¦è¿™ä¸€ä¸ªæ–‡ä»¶ï¼Œéƒ½æ˜¯ä¸€äº›ç®€å•çš„åˆå§‹åŒ–ä»£ç ï¼Œå®ƒé‡Œè¾¹çš„å†…å®¹æ˜¯ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> express </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;express&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">ExpressPeerServer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;peer&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">express</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> server </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">listen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> peerServer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ExpressPeerServer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">server</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  debug</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/video&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> peerServer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿™äº›ä»£ç çš„å«ä¹‰æ˜¯ï¼š</p><ul><li>å¯¼å…¥ express åº“ï¼Œå¹¶ä» peer åº“ä¸­å¯¼å…¥ä¸ express è¿›è¡Œç»“åˆçš„ ExpressPeerServerã€‚</li><li>åˆ›å»º express å®ä¾‹ <code>app</code>Â ï¼Œå¹¶ç›‘å¬ <code>3000</code>Â  ç«¯å£ã€‚</li><li>æŠŠ ExpressPeerServer æŒ‚è½½åˆ° express ä¸­ï¼Œè®¾ç½® <code>debug</code>Â  å¼€å‘æ¨¡å¼ä¸º trueï¼Œè¿™æ ·æœ‰æ›´å¥½çš„é”™è¯¯æç¤ºã€‚è·¯å¾„ä¸ºæ ¹ç›®å½•ã€‚</li><li>ExpressPeerServer æŒ‚è½½ä¹‹åä¼šè¿”å›ä¸€ä¸ª express çš„æ§åˆ¶å™¨ã€‚</li><li>æŠŠè¿”å›çš„æ§åˆ¶å™¨æŒ‚è½½åˆ° <code>/video</code>Â  è·¯å¾„ä¸‹ï¼Œè¿™æ · <code>/video</code>Â  è·¯å¾„å°±æ˜¯ä¸»è¦çš„ã€peer.js æä¾›çš„ WebRTC é€šä¿¡è·¯å¾„ã€‚</li></ul><p>ç„¶åä¿®æ”¹ä¸€ä¸‹ package.json æ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸ª <code>script</code>Â  é…ç½®é¡¹ï¼Œé‡Œè¾¹å®šä¹‰ <code>start</code>Â  å‘½ä»¤å€¼ä¸º <code>nodemon server.js</code>Â ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;scripts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;start&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nodemon server.js&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿™æ ·ä½¿ç”¨ nodemon è¿è¡Œ server.js æ–‡ä»¶åï¼Œå¦‚æœ server.js ä¸­çš„å†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œå®ƒä¼šè‡ªåŠ¨å¸®åŠ©æˆ‘ä»¬é‡å¯æœåŠ¡å™¨ã€‚
æˆ‘ä»¬ç°åœ¨æ¥è¿è¡Œä¸€ä¸‹ <code>yarn start</code>Â  æˆ–è€… <code>npm start</code>Â ï¼Œçœ‹åˆ°å‘½ä»¤è¡Œæç¤º <code>[nodemon] starting node server.js</code>Â  å°±ç®—å¯åŠ¨æˆåŠŸäº†ï¼Œæˆ‘ä»¬è®¿é—®ä¸€ä¸‹ <code>http://localhost:3000/video</code>Â Â ï¼Œçœ‹åˆ°ä¸‹æ–¹è¾“å‡ºç»“æœå°±è¯´æ˜ peer ä¹ŸåŠ è½½æˆåŠŸäº†ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;PeerJS Server&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;A server side element to broker connections between PeerJS clients.&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;website&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://peerjs.com/&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>åç«¯ä»£ç åˆ°è¿™é‡Œå°±ç¼–å†™å®Œæˆäº†ã€‚ä¸‹ä¸€æ­¥å°±æ˜¯åœ¨å‰ç«¯é¡µé¢ä¸­è°ƒç”¨ Peer ç›¸å…³çš„ apiï¼Œå¹¶å»ºç«‹è§†é¢‘é€šè¯ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç”Ÿæˆç”¨æˆ·-id"></a>ç”Ÿæˆç”¨æˆ· ID<a class="hash-link" href="#ç”Ÿæˆç”¨æˆ·-id" title="Direct link to heading">#</a></h2><p>åœ¨å‰ç«¯ä¸­è°ƒç”¨åç«¯ Peer æœåŠ¡å¯ä»¥ä½¿ç”¨ Peer.js å®˜æ–¹çš„å‰ç«¯åº“ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ cdn å½¢å¼ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://unpkg.com/peerjs@1.3.1/dist/peerjs.min.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ä¹Ÿå¯ä»¥æ‰“å¼€ä¸Šè¾¹ src ä¸­çš„ç½‘å€ï¼ŒæŠŠæ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°ï¼Œæˆ–è€…åœ¨ Github ä¸Šä¸‹è½½ï¼š
<a href="https://github.com/peers/peerjs/blob/master/dist/peerjs.min.js" target="_blank" rel="noopener noreferrer">https://github.com/peers/peerjs/blob/master/dist/peerjs.min.js</a>
ä¸‹è½½å®Œæˆä¹‹åæŠŠå®ƒæ”¾åˆ° <code>frontend/peer</code>Â  ç›®å½•ä¸‹ï¼Œç„¶ååœ¨ index.html ä¸­ï¼Œåœ¨å¼•å…¥ index.js çš„ä¸Šæ–¹ï¼Œå¼•å…¥ peerjsï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">peer/peerjs.min.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">index.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>æ¥ä¸‹æ¥æ‰“å¼€ index.js æ–‡ä»¶ï¼Œå»ºç«‹ä¸åå° peer æœåŠ¡çš„è¿æ¥ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> peer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Peer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  host</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;localhost&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  port</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3000&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/video&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿™é‡Œç›´æ¥ä½¿ç”¨ peer.js å‰ç«¯åº“å¯¼å‡ºçš„æ„é€ å‡½æ•° Peer()ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿™é‡Œå°±åˆ†åˆ«æŠŠåå°æœåŠ¡çš„ hostã€port å’Œ path ä¼ é€’è¿›å»å°±å¯ä»¥äº†ï¼Œå®ƒä¼šè¿”å› peer å®ä¾‹ï¼Œåç»­æœ‰å…³è§†é¢‘é€šè¯çš„æ“ä½œå°±ä¸»è¦ä½¿ç”¨å®ƒæ¥å®ç°ã€‚
å½“æˆåŠŸçš„è¿æ¥åˆ°åå°æœåŠ¡ä¹‹åï¼Œæˆ‘ä»¬é¦–å…ˆç»™è‡ªå·±ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ç”¨æˆ· IDï¼Œå°±ç­‰åŒäºæ˜¯ä¸€ä¸ªç”µè¯å·ç ï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›‘å¬ peer çš„ <strong>open</strong>Â  äº‹ä»¶ï¼Œå½“è¿æ¥æ‰“å¼€åï¼Œä¼šæŠŠç”Ÿæˆçš„ç”¨æˆ· ID è¿”å›åˆ°äº‹ä»¶å¤„ç†å›è°ƒå‡½æ•°ä¸­ï¼Œç„¶åæˆ‘ä»¬è·å– html ä¸­çš„ <code>#idText</code>Â  è¿™ä¸ª p å…ƒç´ æ¥æ˜¾ç¤ºè‡ªå·±çš„ IDï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> idText </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementById</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;idText&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">peer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;open&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  idText</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">textContent</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;æˆ‘çš„ id æ˜¯ï¼š&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿™æ—¶åœ¨ Live Server ä¸­æ‰“å¼€ index.htmlï¼Œå°±å¯ä»¥çœ‹åˆ°æ˜¾ç¤ºå‡ºäº† IDï¼Œç±»ä¼¼äºï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">æˆ‘çš„ id æ˜¯ï¼š</span><span class="token number" style="color:#36acaa">2573</span><span class="token plain">c3ae</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ba79</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">404</span><span class="token plain">a</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">b807</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">2128856</span><span class="token plain">ef3c9</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å¤šæ‰“å¼€å‡ ä¸ªé¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°æ¯ä¸ªäººçš„ ID éƒ½ä¸åŒã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å‘¼å«è§†é¢‘é€šè¯"></a>å‘¼å«è§†é¢‘é€šè¯<a class="hash-link" href="#å‘¼å«è§†é¢‘é€šè¯" title="Direct link to heading">#</a></h2><p>åœ¨æœ‰äº†ç”¨æˆ· ID ä¹‹åï¼Œå°±å¯ä»¥å‘¼å«å¯¹æ–¹äº†ã€‚è¿™é‡Œçš„é€»è¾‘æ˜¯ï¼Œç”¨æˆ·åœ¨è¾“å…¥æ¡†è¾“å…¥å¯¹æ–¹ ID ä¹‹åï¼Œç‚¹å‡»è§†é¢‘é€šè¯æŒ‰é’®è¿›è¡Œå‘¼å«ã€‚é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å…ˆè·å–è§†é¢‘é€šè¯æŒ‰é’®å…ƒç´ ï¼Œç„¶åç›‘å¬å®ƒçš„ç‚¹å‡»äº‹ä»¶ï¼Œåœ¨é‡Œè¾¹å‘èµ·å‘¼å«ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> joinBtn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementById</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;joinBtn&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// å‘èµ·å‘¼å«</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">joinBtn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;click&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> peerId </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> peerIdInput</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;æ­£åœ¨è¿æ¥ï¼š&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> peerId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">navigator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mediaDevices</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getUserMedia</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> video</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> audio</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">stream</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> call </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> peer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">peerId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> stream</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      call</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;stream&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> showVideo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>åœ¨ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ï¼Œäº‹ä»¶å¤„ç†å‡½æ•°ä½œäº†å¦‚ä¸‹æ“ä½œï¼š</p><ul><li>è·å–ç”¨æˆ·è¾“å…¥çš„å¯¹æ–¹çš„ IDã€‚</li><li>è·å–å½“å‰ç”¨æˆ·çš„è§†é¢‘æµï¼Œç„¶åè°ƒç”¨ <code>peer.call()</code>Â  å‘¼å«å¯¹æ–¹ï¼Œ <code>peer.call()</code>Â  éœ€è¦å¯¹æ–¹çš„ ID å’Œè‡ªå·±çš„è§†é¢‘æµä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›ä¸å‘¼å«æœ‰å…³çš„å®ä¾‹ï¼Œä¿å­˜åˆ° call ä¸­ã€‚</li><li>è¿™æ—¶å½“å‰ç”¨æˆ·å°±å¼€å§‹ç­‰å¾…å¯¹æ–¹åº”ç­”äº†ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œè¿™é‡Œæ²¡æœ‰åšç­‰å¾…çš„æ ·å¼ã€‚</li><li>ä¸‹ä¸€æ­¥ç›‘å¬ call çš„ <strong>stream</strong>Â  äº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶ä¼šåœ¨å¯¹æ–¹åº”ç­”åè§¦å‘ï¼Œå®ƒä¼šè¿”å›å¯¹æ–¹çš„è§†é¢‘æµä½œä¸ºäº‹ä»¶å¤„ç†å‡½æ•°çš„å‚æ•°ï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨ <code>showVideo()</code>Â  å‡½æ•°å¤„ç†å¯¹æ–¹çš„è§†é¢‘æµã€‚</li></ul><p><code>showVideo()</code>Â  å‡½æ•°çš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> peerVideo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementById</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;peerVideo&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">showVideo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">stream</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  myVideo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">classList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;rightTop&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  peerVideo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">srcObject</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> stream</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  peerVideo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">style</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">display</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;block&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿™ä¸ªå‡½æ•°å°±æ˜¯ç®€å•çš„æŠŠè‡ªå·±çš„è§†é¢‘ç§»åŠ¨åˆ°å³ä¸Šè§’ï¼Œé€šè¿‡ä¹‹å‰å®šä¹‰çš„ <code>.rightTop</code>Â class æ ·å¼ï¼Œç„¶åæŠŠå¯¹æ–¹çš„è§†é¢‘æµæ”¾åˆ° <code>#peerVideo</code>Â  è§†é¢‘ç»„ä»¶ä¸­ï¼Œä¹‹åæŠŠå®ƒæ˜¾ç¤ºå‡ºæ¥ï¼ˆä¹‹å‰è®¾ç½®çš„æ˜¯ <code>display: none</code>Â  éšè—ï¼‰ã€‚ç°åœ¨å› ä¸ºä¸€ç›´æ˜¯ç­‰å¾…å¯¹æ–¹æ¥å¬ï¼Œæ‰€ä»¥éœ€è¦æœ‰ä¸€ä¸ªåº”ç­”çš„å¤„ç†ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åº”ç­”è§†é¢‘é€šè¯"></a>åº”ç­”è§†é¢‘é€šè¯<a class="hash-link" href="#åº”ç­”è§†é¢‘é€šè¯" title="Direct link to heading">#</a></h2><p>åº”ç­”çš„å¤„ç†æ˜¯ç›‘å¬ peer çš„ <strong>call</strong>Â  äº‹ä»¶ï¼Œç„¶åé€šè¿‡äº‹ä»¶å‚æ•°ä¸­ä¸å‘¼å«æœ‰å…³çš„å®ä¾‹æ¥åº”ç­”é€šè¯ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// åº”ç­”å‘¼å«</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">peer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;call&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">call</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">navigator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mediaDevices</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getUserMedia</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> video</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> audio</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">stream</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      call</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">answer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stream</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      call</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;stream&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> showVideo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿™ä¸€æ­¥çš„ä»£ç è™½ç„¶åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä½†æ˜¯åº”è¯¥æƒ³è±¡ä¸ºæ”¶åˆ°è§†é¢‘é€šè¯å‘¼å«çš„å¯¹æ–¹ï¼Œä»£ç ä½œäº†ä¸‹è¾¹çš„æ“ä½œï¼š</p><ul><li>è·å–è‡ªå·±çš„è§†é¢‘æµã€‚</li><li>è°ƒç”¨ <code>answer()</code>Â  å‡½æ•°åº”ç­”è§†é¢‘å‘¼å«ï¼Œå¹¶æŠŠè‡ªå·±çš„è§†é¢‘æµä¼ å›ç»™å‘¼å«è€…ã€‚è¿™é‡Œæ˜¯å½“æœ‰å‘¼å«æ—¶ç›´æ¥è¿›è¡Œåº”ç­”ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæ²¡æœ‰ç¼–å†™ç‚¹å‡»åº”ç­”æŒ‰é’®ç›¸å…³çš„æ ·å¼å’Œäº‹ä»¶ã€‚</li><li>ç›‘å¬ <strong> stream </strong>Â  äº‹ä»¶ï¼Œè¿™ä¸€æ­¥å’Œä¹‹å‰çš„ä¸€æ ·ï¼Œåº”ç­”åè¿™ä¸ªäº‹ä»¶å°±ä¼šè§¦å‘ï¼Œç„¶ååŒæ ·ä½¿ç”¨ <code>showVideo()</code> å‡½æ•°åŠ è½½è§†é¢‘ã€‚</li></ul><p>å¥½äº†ï¼Œç°åœ¨æ‰“å¼€ä¸¤ä¸ªé¡µé¢è¯•è¯•ï¼Œåœ¨å…¶ä¸­ä¸€ä¸ªé¡µé¢è¾“å…¥å¦ä¸€ä¸ªé¡µé¢ç”Ÿæˆçš„ IDï¼Œç„¶åç‚¹å‡»è§†é¢‘é€šè¯ï¼Œå°±å¯ä»¥çœ‹åˆ°åŒæ–¹è§†é¢‘æ˜¾ç¤ºå‡ºæ¥äº†ã€‚å¦‚æœç”¨çš„æ˜¯åŒä¸€ä¸ªæ‘„åƒå¤´ï¼Œé‚£ä¹ˆæ˜¾ç¤ºçš„ç”»é¢éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å®ç°æ¢è„¸"></a>å®ç°æ¢è„¸<a class="hash-link" href="#å®ç°æ¢è„¸" title="Direct link to heading">#</a></h2><p>å®ç°æ¢è„¸ä¸»è¦æ˜¯ç”¨åˆ°äº† Avatarify è¿™ä¸ª AI æ¢è„¸åº“ï¼Œå®ƒæ˜¯ä½¿ç”¨ Python ç¼–å†™çš„ï¼Œåˆ©ç”¨äº† First-Order Motion Model ç®—æ³•æ¥å®ç°æ¢è„¸ã€‚æˆ‘ä»¬è¿™é‡Œåªéœ€è¦æŒ‰ç…§æ­¥éª¤è¿›è¡Œå®‰è£…å°±å¯ä»¥äº†ï¼Œæ­¤å¤–è¿˜éœ€è¦å®‰è£…è™šæ‹Ÿæ‘„åƒå¤´è½¯ä»¶ï¼Œç”¨äºæŠŠ Avatarify æ¢è„¸åçš„æ•°æ®ä½œä¸ºæ‘„åƒå¤´è§†é¢‘ï¼Œç„¶ååœ¨å‰ç«¯é¡µé¢ä¸­è®¿é—®è¿™ä¸ªè™šæ‹Ÿçš„æ‘„åƒå¤´ã€‚
Avatarify ç”±äºæ˜¯å¯¹æ‘„åƒå¤´çš„è§†é¢‘è¿›è¡Œå®æ—¶è®¡ç®—ï¼Œæ‰€ä»¥å¯¹æ˜¾å¡çš„è¦æ±‚éå¸¸é«˜ï¼Œä¸”åªæ”¯æŒå¯ç”¨äº† CUDA çš„ Nvidia æ˜¾å¡æ¥è¿›è¡Œ GPU åŠ é€Ÿï¼Œå®˜æ–¹çš„ç»Ÿè®¡æ•°æ®æ˜¯è¿™æ ·çš„ï¼š</p><ul><li>GeForce GTX 1080 Ti: 33 å¸§/ç§’</li><li>GeForce GTX 1070: 15 å¸§/ç§’</li><li>GeForce GTX 950: 9 å¸§/ç§’</li></ul><p>å¦‚æœé…ç½®è¾¾ä¸åˆ°ï¼Œå¯ä»¥ä½¿ç”¨è…¾è®¯äº‘æˆ–é˜¿é‡Œäº‘çš„ GPU å®ä¾‹ï¼ŒæŠŠæ˜¾å¡æœ‰å…³çš„è®¡ç®—äº¤ç»™è¿œç¨‹æœåŠ¡å™¨å»è¿›è¡Œï¼Œæœ¬åœ°åªéœ€è¦å»ºç«‹è§†é¢‘æµå³å¯ã€‚æœ¬æ–‡å°†ä¸»è¦ä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚
å¦‚æœé…ç½®è¾¾åˆ°äº†è¦æ±‚ï¼Œä¹Ÿå¯ä»¥åœ¨æœ¬åœ°å®‰è£…è¿è¡Œï¼Œä¸è¿‡æˆ‘æ²¡æœ‰è¯•è¿‡ï¼Œåè¾¹ç®€å•çš„è´´ä¸€ä¸‹å®˜æ–¹å®‰è£…æŒ‡å¯¼ï¼ˆWindows ä¸‹ï¼‰ï¼Œä½ å¯ä»¥è‡ªå·±å°è¯•ä¸€ä¸‹ã€‚
è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ˜¯åœ¨æœ¬åœ°è¿è¡Œç®—æ³•ï¼Œå¯ä»¥åœ¨ Windows å’Œ Linux æ“ä½œç³»ç»Ÿä¸­è¿›è¡Œï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨ docker è¿›è¡Œéƒ¨ç½²ï¼Œä¸è¿‡åªæ”¯æŒ linux æ“ä½œç³»ç»Ÿä¸‹çš„ dockerã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="è´­ä¹°æœåŠ¡å™¨"></a>è´­ä¹°æœåŠ¡å™¨<a class="hash-link" href="#è´­ä¹°æœåŠ¡å™¨" title="Direct link to heading">#</a></h3><p>è¿™é‡Œä»¥è…¾è®¯äº‘ GPU å®ä¾‹ä¸ºä¾‹ï¼Œä»‹ç»ä¸€ä¸‹æœåŠ¡å™¨çš„é…ç½®ï¼Œå…³äºè®¡è´¹æˆ‘ä»¬ä¼šä½¿ç”¨æŒ‰é‡è®¡è´¹ï¼Œå®Œæˆè¿™ç¯‡æ•™ç¨‹æ‰€ç”¨çš„æ€»ä½“è´¹ç”¨å¯èƒ½åœ¨ 30 å…ƒå·¦å³ï¼Œ
ç”¨å®Œä¹‹åä¸€å®šè¦è®°å¾—<strong>å…³æœºæˆ–è€…é”€æ¯æ¥åœæ­¢è®¡è´¹</strong>ã€‚å¦‚æœæ˜¯å…³æœºï¼Œè®°å¾—å…ˆæŠŠå¸¦å®½è°ƒæ•´ä¸º 0ï¼Œåœæ­¢å¸¦å®½è®¡è´¹ï¼Œç„¶åå…³æœºæ—¶é€‰æ‹©å…³æœºä¸æ”¶è´¹é€‰é¡¹ã€‚
æ‰“å¼€ä¸‹æ–¹é“¾æ¥ï¼ˆæˆ–å¤åˆ¶ <a href="https://curl.qcloud.com/KiCrCXo9" target="_blank" rel="noopener noreferrer">https://curl.qcloud.com/KiCrCXo9</a> ï¼‰ï¼š</p><p><a href="https://cloud.tencent.com/act/cps/redirect?redirect=1001&amp;cps_key=2c427bf21a8dbca51ee45224ab31c2a9&amp;from=console" target="_blank" rel="noopener noreferrer">è…¾è®¯äº‘æœåŠ¡å™¨è´­ä¹°é“¾æ¥</a></p><p>ç„¶ååœ¨é€‰æ‹©æœºå‹ä¸­é€‰æ‹©å¦‚ä¸‹é…ç½®ï¼š</p><ul><li>è®¡è´¹æ¨¡å¼ï¼šæŒ‰é‡è®¡è´¹ã€‚</li><li>åœ°åŸŸï¼šä¸­å›½é¦™æ¸¯ã€‚è¿™é‡Œé€‰æ‹©é¦™æ¸¯åœ°åŒºçš„åŸå› æ˜¯å®‰è£… Avatarify éœ€è¦å¤§é‡çš„å¢ƒå¤–æºï¼Œä¾‹å¦‚ Githubã€Dockerã€Nividiaã€Python ç­‰ï¼Œä¸”æ•°é‡å¤šï¼Œä½“ç§¯ä¹Ÿå¤§ï¼ˆæœ‰çš„ 700 å¤š Mï¼‰ï¼Œåœ¨äº²èº«æµ‹è¯•è¿‡å›½å†…åŒºçš„ä¹‹åï¼Œå‘ç°è¡Œä¸é€šï¼Œè€Œé¦™æ¸¯åœ°åŒºå› ä¸ºå»¶è¿Ÿç›¸å¯¹è¾ƒä½ï¼Œä¸”è®¿é—®å¢ƒå¤–æºé€Ÿåº¦å¿«ï¼Œæ‰€ä»¥è¿™é‡Œé€‰æ‹©äº†é¦™æ¸¯ã€‚</li><li>å®ä¾‹ï¼šé€‰æ‹© GPU å‹ï¼Œåœ¨æœºå‹åˆ—è¡¨ä¸­é€‰æ‹© GPU è®¡ç®—å‹ GN7ï¼Œè¿™ä¸ªæ˜¯æœ€ä¾¿å®œçš„ï¼Œ7.16 å…ƒ/å°æ—¶ã€‚</li><li>é•œåƒï¼šé€‰æ‹© Ubuntu 64 ä½ 18.04ï¼Œä¸è¦é€‰è¿‡é«˜çš„ç‰ˆæœ¬ã€‚æ˜¾å¡é©±åŠ¨å¯èƒ½æ”¯æŒä¸å®Œå–„ã€‚</li><li>å‹¾é€‰ä¸Šåå°è‡ªåŠ¨å®‰è£… GPU é©±åŠ¨ï¼ŒCUDA ç‰ˆæœ¬é€‰æ‹© 10.0.130ï¼ŒcuDNN ç‰ˆæœ¬é€‰æ‹© 7.4.2ã€‚</li><li>å¸¦å®½å®æµ‹éœ€è¦ 20M èµ·æ­¥ï¼Œå¤§æ¦‚ 1 å…ƒ/å°æ—¶ï¼Œä¸è¿‡åœ¨å®‰è£… Avatarify çš„æ—¶å€™å¸¦å®½å¯ä»¥å°ä¸€ç‚¹ï¼Œåè¾¹çœŸæ­£å¼€å¯è§†é¢‘çš„æ—¶å€™å†æŠŠå®ƒæ”¹å¤§ã€‚</li><li><strong>æ³¨æ„è¿™é‡Œç³»ç»Ÿç›˜è´¹ç”¨æ˜¯ 0.03 å…ƒ/å°æ—¶ï¼Œè¿™ä¸ªåœ¨å…³æœºåä»ç„¶ä¼šæ”¶å–</strong>ã€‚</li></ul><p>åœ¨ä¸‹ä¸€æ­¥è®¾ç½®ä¸»æœºä¸­ï¼š</p><ul><li>æ–°å»ºå®‰å…¨ç»„ã€‚</li><li>ç™»å½•æ–¹å¼è¿™é‡Œä½¿ç”¨å¯†ç ï¼Œå¯ä»¥é€‰æ‹©è‡ªè¡Œè®¾ç½®ï¼Œä¹Ÿå¯ä»¥è‡ªåŠ¨ç”Ÿæˆã€‚</li></ul><p>å†ä¸‹ä¸€æ­¥ç¡®è®¤æˆåŠŸåå®Œæˆè´­ä¹°ï¼Œç¨åå°±å¯ä»¥åœ¨æ§åˆ¶å°å®ä¾‹åˆ—è¡¨ä¸­çœ‹åˆ°åˆšè´­ä¹°çš„å®ä¾‹äº†ï¼Œæ–°è´­ä¹°çš„æœºå™¨å¯èƒ½éœ€è¦ç­‰ 5 åˆ†é’Ÿæ‰èƒ½é…ç½®å®Œæˆã€‚å¦‚æœè¦ä¿®æ”¹å¸¦å®½ï¼Œå¯ä»¥åœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°å¯¹åº”çš„å®ä¾‹ï¼Œåœ¨æœ€å³ä¾§æ“ä½œæ é‡Œé€‰æ‹©æ›´å¤š-&gt;èµ„æºè°ƒæ•´-&gt;è°ƒæ•´å¸¦å®½ï¼Œè¿›è¡Œè°ƒæ•´ã€‚
å› ä¸º Avatarify éœ€è¦ä½¿ç”¨ 5557 å’Œ 5558 ç«¯å£ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å®‰å…¨ç»„ä¸­æ”¾è¡Œè¿™ä¸¤ä¸ªç«¯å£ã€‚ç‚¹å‡»å®ä¾‹åç§°è¶…é“¾æ¥ï¼Œè¿›å…¥å®ä¾‹è¯¦æƒ…é¡µé¢ï¼Œåœ¨ä¸Šæ–¹é€‰é¡¹å¡ä¸­é€‰æ‹© <strong>å®‰å…¨ç»„</strong>Â ï¼Œåœ¨å³ä¾§ <strong>è§„åˆ™é¢„è§ˆ</strong>Â  ä¸­çš„ <strong>å…¥ç«™è§„åˆ™</strong>Â  é€‰é¡¹å¡é‡Œï¼Œç‚¹å‡» <strong>ç¼–è¾‘è§„åˆ™</strong>ï¼Œåœ¨æ–°é¡µé¢é‡Œçš„å…¥ç«™è§„åˆ™é‡Œï¼Œç‚¹å‡» <strong>æ·»åŠ è§„åˆ™ï¼Œ</strong>åœ¨å¯¹è¯æ¡†é‡Œå¡«å†™ï¼š</p><ul><li>ç±»å‹ï¼šè‡ªå®šä¹‰ã€‚</li><li>æ¥æºï¼šallã€‚</li><li>åè®®ç«¯å£ï¼šTCP:5557,5558</li><li>ç­–ç•¥ï¼šå…è®¸ã€‚</li></ul><p>ç‚¹å‡»å®Œæˆå³å¯ã€‚åˆ°è¿™é‡Œå®ä¾‹é…ç½®å°±å®Œæˆäº†ï¼Œç•™æ„ä¸€ä¸‹å®ä¾‹çš„å…¬ç½‘ IP åœ°å€ï¼Œç¨åä½¿ç”¨ SSH ç™»å½•æ—¶éœ€è¦ç”¨åˆ°å®ƒã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="éƒ¨ç½²-avatarify"></a>éƒ¨ç½² Avatarify<a class="hash-link" href="#éƒ¨ç½²-avatarify" title="Direct link to heading">#</a></h3><p>æˆ‘ä»¬ä½¿ç”¨ Docker çš„æ–¹å¼æ¥éƒ¨ç½² Avatarifyï¼Œå…ˆç™»å½•åˆ°æˆ‘ä»¬çš„ GPU å®ä¾‹ä¸­ï¼Œå¯ä»¥ç›´æ¥åœ¨è…¾è®¯äº‘æ§åˆ¶å°ç™»å½•ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ ssh å‘½ä»¤æˆ– putty å·¥å…·ã€‚è¿™é‡Œä»¥ ssh ä¸ºä¾‹ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"> ubuntu@ä½ çš„å®ä¾‹ip</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ç„¶åæ ¹æ®æç¤ºè¾“å…¥å¯†ç ï¼Œç¬¬ä¸€æ¬¡ç™»å½•å¯èƒ½æœ‰ä¸€å¤§æ®µè‹±æ–‡æç¤ºï¼ˆæ˜¯å¦ä¿¡ä»»è®¾å¤‡ï¼‰ï¼Œç›´æ¥è¾“å…¥ yes å›è½¦å³å¯ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å®‰è£…-docker"></a>å®‰è£… Docker<a class="hash-link" href="#å®‰è£…-docker" title="Direct link to heading">#</a></h4><p>ç™»å½•è¿›å»ä¹‹åå…ˆå®‰è£… dockerï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ç®€æ˜“çš„å®‰è£…è„šæœ¬ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -fsSL https://get.docker.com -o get-docker.sh</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sh</span><span class="token plain"> get-docker.sh</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ä¸è¿‡å®æµ‹é¦™æ¸¯çš„å®ä¾‹å¥½åƒå¹¶ä¸èƒ½è®¿é—®è¿™ä¸ªè„šæœ¬ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨æ™®é€šæ–¹å¼å®‰è£…ï¼ŒæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å¤åˆ¶ç²˜è´´å‘½ä»¤ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># ç¬¬ä¸€æ­¥</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> update</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ç¬¬äºŒæ­¥</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    apt-transport-https </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ca-certificates </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    gnupg</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ç¬¬ä¸‰æ­¥</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -fsSL https://download.docker.com/linux/ubuntu/gpg </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ç¬¬å››æ­¥</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  </span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable" style="color:#36acaa">lsb_release -cs</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c"> stable&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tee</span><span class="token plain"> /etc/apt/sources.list.d/docker.list </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /dev/null</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿™äº›æ­¥éª¤éƒ½æ˜¯åœ¨é…ç½® Docker çš„å®‰è£…ä»“åº“æºå’Œå¯†é’¥ï¼Œæ¥ä¸‹æ¥è¿è¡Œä¸‹é¢ä¸¤æ¡å‘½ä»¤æ¥å®‰è£… Dockerï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> update</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> docker-ce docker-ce-cli containerd.io</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å®‰è£…å®Œæˆä¹‹åï¼Œ <code>docker</code>Â  å‘½ä»¤éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è¿è¡Œï¼Œæ¯æ¬¡éƒ½éœ€è¦è¾“å…¥ <code>sudo</code>ï¼Œå¦‚æœè¦çœç•¥ <code>sudo</code>Â ï¼Œå¯ä»¥æŠŠå½“å‰ç”¨æˆ·ï¼ˆè…¾è®¯äº‘é»˜è®¤ä¸º ubuntuï¼‰æ·»åŠ åˆ° docker ç”¨æˆ·ç»„ä¸­ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">usermod</span><span class="token plain"> -aG docker ubuntu</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ä¹‹åé€€å‡º ssh å¹¶é‡æ–°ç™»å½•æ¥è®©é…ç½®ç”Ÿæ•ˆï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤æ£€æŸ¥ docker æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker run hello-world</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>æœ‰æ‰“å°å‡º hello world å­—æ ·å’Œä¸€å¤§æ®µè‹±æ–‡å°±è¯´æ˜æˆåŠŸäº†ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å®‰è£…-nvidia-docker-tookit"></a>å®‰è£… Nvidia Docker tookit<a class="hash-link" href="#å®‰è£…-nvidia-docker-tookit" title="Direct link to heading">#</a></h4><p>è¦è®© docker ä½¿ç”¨ GPUï¼Œéœ€è¦å®‰è£… Nvidia Docker tookitï¼Œè¿™ä¸€æ­¥ä¹Ÿå¾ˆç®€å•ï¼Œé¦–å…ˆè®¾ç½® Nvidia çš„ä»“åº“æºï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">distribution</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable builtin class-name" style="color:#36acaa">.</span><span class="token variable" style="color:#36acaa"> /etc/os-release</span><span class="token variable punctuation" style="color:#393A34">;</span><span class="token variable builtin class-name" style="color:#36acaa">echo</span><span class="token variable" style="color:#36acaa"> $ID$VERSION_ID</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -s -L https://nvidia.github.io/nvidia-docker/gpgkey </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> apt-key </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> - </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -s -L https://nvidia.github.io/nvidia-docker/</span><span class="token variable" style="color:#36acaa">$distribution</span><span class="token plain">/nvidia-docker.list </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tee</span><span class="token plain"> /etc/apt/sources.list.d/nvidia-docker.list</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ç„¶åå®‰è£… tookit å¹¶é‡å¯ Dockerï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> update</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> -y nvidia-docker2</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> systemctl restart docker</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿è¡Œä¸€ä¸ªç¤ºä¾‹ container æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> docker run --rm --gpus all nvidia/cuda:11.0-base nvidia-smi</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å¦‚æœæ‰“å°å‡ºç±»ä¼¼çš„å¦‚ä¸‹ä¿¡æ¯å°±ç®—æˆåŠŸäº†ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Fri Mar  </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> 08:47:39 </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------------------------------------------------+</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> NVIDIA-SMI </span><span class="token number" style="color:#36acaa">418.126</span><span class="token plain">.02   Driver Version: </span><span class="token number" style="color:#36acaa">418.126</span><span class="token plain">.02   CUDA Version: </span><span class="token number" style="color:#36acaa">11.0</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">-------------------------------+----------------------+----------------------+</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> GPU  Name        Persistence-M</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Bus-Id        Disp.A </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Volatile Uncorr. ECC </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Fan  Temp  Perf  Pwr:Usage/Cap</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">         Memory-Usage </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> GPU-Util  Compute M. </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">+=</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">+=</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  Tesla T4            Off  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 00000000:00:08.0 Off </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">                    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> N/A   26C    P8     9W /  70W </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">      0MiB / 15079MiB </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">%      Default </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------+----------------------+----------------------+</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------------------------------------------------+</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Processes:                                                       GPU Memory </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  GPU       PID   Type   Process name                             Usage      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  No running processes found                                                 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------------------------------------------------+</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ„å»º-avatarify-docker-é•œåƒ"></a>æ„å»º Avatarify Docker é•œåƒ<a class="hash-link" href="#æ„å»º-avatarify-docker-é•œåƒ" title="Direct link to heading">#</a></h4><p>é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä½¿ç”¨ git å…‹éš† Avatarify ä»“åº“ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/alievk/avatarify.git</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿›å…¥åˆ°å…‹éš†ä¸‹æ¥çš„ avatarify ä»“åº“ä¸­ï¼Œä½¿ç”¨ docker æ„å»ºé•œåƒï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> avatarify</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker build -t avatarify </span><span class="token builtin class-name">.</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>æ„å»ºéœ€è¦çš„æ—¶é—´æ¯”è¾ƒé•¿ï¼Œè€å¿ƒç­‰å¾…å®Œæˆä¹‹åï¼Œå¯åŠ¨æœåŠ¡ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">bash</span><span class="token plain"> run.sh --is-worker --docker</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>çœ‹åˆ°æœ‰ 5557 å’Œ 5558 ç«¯å£å°±è¯´æ˜å¯åŠ¨æˆåŠŸäº†ã€‚åˆ°ç°åœ¨ï¼ŒAvatarify çš„æœåŠ¡ç«¯é…ç½®å®Œæˆäº†ï¼Œä¹‹åå°±æ˜¯ä½¿ç”¨å®¢æˆ·ç«¯è°ƒç”¨æœåŠ¡ï¼ŒæŠŠè®¡ç®—éƒ¨åˆ†äº¤ç»™æˆ‘ä»¬çš„ GPU å®ä¾‹ã€‚è¿™æ—¶å¦‚æœæ‹…å¿ƒè®¡è´¹ï¼Œå¯ä»¥å…ˆæŠŠå®ä¾‹å…³æœºï¼Œåœ¨æœ¬åœ°å®‰è£…å¥½å®¢æˆ·ç«¯åå†å¼€æœºã€‚
æ¥ä¸‹æ¥çš„æ­¥éª¤ä»¥ MacOS ä¸ºä¾‹ï¼ŒWindows ç‰ˆå¯ä»¥ç›´æ¥è·³åˆ°åè¾¹çš„ <strong>Windows å®‰è£…æ–¹æ³•</strong>Â  å°èŠ‚ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å®‰è£…-avatarify-å®¢æˆ·ç«¯"></a>å®‰è£… Avatarify å®¢æˆ·ç«¯<a class="hash-link" href="#å®‰è£…-avatarify-å®¢æˆ·ç«¯" title="Direct link to heading">#</a></h3><p>åœ¨æœ¬åœ°ç”µè„‘ä¸Šï¼Œé¦–å…ˆå®‰è£… Miniconda Python 3.8ï¼Œå¯ä»¥ä»è¿™é‡Œä¸‹è½½ï¼š
<a href="https://docs.conda.io/en/latest/miniconda.html#macosx-installers" target="_blank" rel="noopener noreferrer">https://docs.conda.io/en/latest/miniconda.html#macosx-installers</a>
æˆ–è€…ä½¿ç”¨ Homebrewï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brew </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> --cask miniconda</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å…‹éš† avatarify ä»“åº“å¹¶è¿è¡Œå®‰è£…è„šæœ¬ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/alievk/avatarify.git</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> avatarify</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">bash</span><span class="token plain"> scripts/install_mac.sh</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ä¸‹è½½ CamTwist è™šæ‹Ÿæ‘„åƒå¤´è½¯ä»¶ï¼ˆç±»ä¼¼ OBSï¼Œä½†æ˜¯ OBS çš„è™šæ‹Ÿæ‘„åƒå¤´åœ¨ Mac ä¸­è®¿é—®ä¸åˆ°ï¼‰å¹¶å®‰è£…ï¼š
<a href="http://camtwiststudio.com/download" target="_blank" rel="noopener noreferrer">http://camtwiststudio.com/download</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å¯åŠ¨-avatarify-å®¢æˆ·ç«¯"></a>å¯åŠ¨ Avatarify å®¢æˆ·ç«¯<a class="hash-link" href="#å¯åŠ¨-avatarify-å®¢æˆ·ç«¯" title="Direct link to heading">#</a></h3><p>ç¡®ä¿è¿œç¨‹ GPU å®ä¾‹å·²å¯åŠ¨ï¼Œä¸”è¿è¡Œäº† avatarify docker é•œåƒç›‘å¬ 5557 å’Œ 5558 ç«¯å£ï¼Œç„¶ååœ¨æœ¬åœ°å…‹éš†çš„ avatarify ä»“åº“ä¸­ï¼Œè¿è¡Œ mac å®¢æˆ·ç«¯ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">./run_mac.sh --is-client --in-addr tcp://server_address:5557 --out-addr tcp://server_address:5558</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è®°å¾—æŠŠä¸¤ä¸ª <code>server_address</code>Â  æ”¹æˆ GPU å®ä¾‹çš„å…¬ç½‘ IPã€‚æœåŠ¡ç«¯å¯èƒ½éœ€è¦ä¸‹è½½ä¸€äº›å¿…è¦çš„æ–‡ä»¶ï¼Œæ‰€ä»¥è¿æ¥ä¼šæ…¢ä¸€äº›ï¼Œç¨ç­‰å¯åŠ¨æˆåŠŸå Avatarify ä¼šè‡ªåŠ¨æ‰“å¼€æ‘„åƒå¤´çª—å£ã€‚
æˆ‘ä»¬å¯ä»¥æ ¹æ®æç¤ºè°ƒæ•´å¥½è„¸éƒ¨ä½ç½®ï¼Œè¿™é‡Œæˆ‘ä»¬æœ€å¥½æŠŠè„¸æ”¾åˆ°çº¢è‰²çŸ©å½¢æ¡†ä¸­ï¼Œå…‰çº¿è¦å……è¶³ï¼Œä¸èƒ½å¤ªé»‘ï¼Œå¯ä»¥ä½¿ç”¨ W/D é”®ç¼©æ”¾ç”»é¢ï¼Œè°ƒæ•´å¥½ä¹‹åæŒ‰ X é”®å°±å¯ä»¥å‘¼å‡ºæ¢è„¸ä¹‹åçš„é¢„è§ˆè§†é¢‘çª—å£ï¼Œå®ƒå°±æ˜¯ä½œä¸ºè™šæ‹Ÿæ‘„åƒå¤´çš„è§†é¢‘æ¥æºã€‚
Avatarify å†…ç½®äº† 9 å¼ ç¤ºä¾‹çš„äººè„¸ç…§ç‰‡ï¼Œå¯ä»¥æŒ‰ 1-9 é”®è¿›è¡Œåˆ‡æ¢ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰äººè„¸ç…§ç‰‡ï¼Œæ”¾åˆ° Avatarify ä¸­çš„ <code>avatars</code>Â  æ–‡ä»¶å¤¹ä¸‹ã€‚
Avatarify æˆåŠŸæ˜¾ç¤ºä¹‹åï¼Œæ‰“å¼€ CamTwist è™šæ‹Ÿæ‘„åƒå¤´ï¼Œåœ¨å·¦ä¾§é€‰æ‹© Desktop+ï¼Œç„¶åç‚¹å‡»åº•éƒ¨çš„ selectï¼Œç„¶ååœ¨å³ä¾§çš„ settings ä¸‹ï¼Œå‹¾ä¸Š Confine to Application Windowï¼Œç„¶åå‹¾ä¸Šä¸‹æ–¹çš„ Select from existing windowsÂ ï¼Œåœ¨ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹© python (avatarify)Â ï¼Œå¦‚æœæ‰¾ä¸åˆ°å¯ä»¥é€€å‡º CamTwist é‡æ–°æ‰“å¼€ï¼Œæˆ–è€…å¤šç‚¹å‡»ä¸‹æ‹‰æ¡†å‡ æ¬¡è¯•è¯•ã€‚ç°åœ¨è™šæ‹Ÿæ‘„åƒå¤´å°±å‡†å¤‡å¥½äº†ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="windows-å®‰è£…æ–¹æ³•"></a>Windows å®‰è£…æ–¹æ³•<a class="hash-link" href="#windows-å®‰è£…æ–¹æ³•" title="Direct link to heading">#</a></h3><p>åœ¨ Windows ä¸‹çš„å®‰è£…æ–¹æ³•ä¸ MacOS ç±»ä¼¼ï¼Œè€Œä¸”å¦‚æœæ˜¾å¡é…ç½®å¤Ÿé«˜ï¼Œå¯ä»¥çœç•¥è´­ä¹°è¿œç¨‹ GPU æœåŠ¡å™¨æ­¥éª¤ã€‚</p><ol><li>é¦–å…ˆå®‰è£… Minicoda Python 3.8ï¼Œå¯ä»¥ä»è¿™é‡Œä¸‹è½½ï¼š</li></ol><p><a href="https://docs.conda.io/en/latest/miniconda.html#windows-installers" target="_blank" rel="noopener noreferrer">https://docs.conda.io/en/latest/miniconda.html#windows-installers</a></p><ol start="2"><li>å®‰è£…å®Œæˆä¹‹åæ‰“å¼€ Anaconda å‘½ä»¤æç¤ºç¬¦ï¼Œå…‹éš† avatarify ä»“åº“ï¼Œå¹¶è¿è¡Œ windows æ“ä½œç³»ç»Ÿä¸‹çš„å®‰è£…è„šæœ¬ï¼š</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/alievk/avatarify.git</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> avatarify</span></span><span class="token-line" style="color:#393A34"><span class="token plain">scripts</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">install_windows.bat</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><ol start="3"><li>å¦‚æœè¦åœ¨æœ¬åœ°æ‰§è¡Œæ¢è„¸ç®—æ³•ï¼Œé‚£ä¹ˆéœ€è¦ä¸‹è½½ network weightsï¼ˆ228 MBï¼‰ï¼š</li></ol><p><a href="https://openavatarify.s3.amazonaws.com/weights/vox-adv-cpk.pth.tar" target="_blank" rel="noopener noreferrer">https://openavatarify.s3.amazonaws.com/weights/vox-adv-cpk.pth.tar</a>
æˆ–
<a href="https://yadi.sk/d/M0FWpz2ExBfgAA" target="_blank" rel="noopener noreferrer">https://yadi.sk/d/M0FWpz2ExBfgAA</a>
æˆ–
<a href="https://drive.google.com/file/d/1coUCdyRXDbpWnEkA99NLNY60mb9dQ_n3/view?usp=sharing" target="_blank" rel="noopener noreferrer">https://drive.google.com/file/d/1coUCdyRXDbpWnEkA99NLNY60mb9dQ_n3/view?usp=sharing</a></p><ol start="4"><li>ä¸‹è½½å®Œæˆåæ”¾åˆ° avatarify çš„æ ¹ç›®å½•ä¸‹ï¼Œæ— éœ€è§£å‹ã€‚</li><li>è¿è¡Œ avatarify å®¢æˆ·ç«¯ï¼Œå¦‚æœæ˜¯åœ¨æœ¬åœ°è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨ï¼š</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/run_windows.bat</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><ol start="6"><li>Windows ç³»ç»Ÿä¸‹ä¹Ÿå¯ä»¥ä½¿ç”¨è¿œç¨‹ GPU å®ä¾‹ï¼Œä½¿ç”¨ä¸‹é¢çš„æ–¹å¼å¯åŠ¨å®¢æˆ·ç«¯ï¼š</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">./scripts/run_windows.bat --is-client --in-addr tcp://server_address:5557 --out-addr tcp://server_address:5558</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><ol start="7"><li>ä¸¤ä¸ª <code>server_address</code>Â  éœ€è¦æ›¿æ¢æˆè¿œç¨‹ GPU å®ä¾‹çš„å…¬ç½‘ IPã€‚</li><li>å¯åŠ¨æˆåŠŸä¹‹åå’Œ Mac çš„æ“ä½œä¸€æ ·ï¼Œä½¿ç”¨ W/D ç¼©æ”¾ç”»é¢ï¼Œå®Œæˆä¹‹åæŒ‰ X é”®è°ƒå‡º avatarify é¢„è§ˆçª—å£ã€‚</li></ol><p>Windows ä¸‹çš„è™šæ‹Ÿæ‘„åƒå¤´å¯ä»¥ä½¿ç”¨ OBSï¼Œæœ€æ–°ç‰ˆçš„ OBS 26.1 åŠä»¥ä¸Šå·²ç»å†…ç½®äº†è™šæ‹Ÿæ‘„åƒå¤´æ’ä»¶äº†ï¼Œæ— éœ€å†å•ç‹¬å®‰è£…ã€‚</p><ol><li>ä¸‹è½½å¹¶å®‰è£… OBSï¼š</li></ol><p><a href="https://obsproject.com/" target="_blank" rel="noopener noreferrer">https://obsproject.com/</a></p><ol start="2"><li>å®‰è£…å®Œæˆä¹‹åæ‰“å¼€ OBSï¼Œåœ¨å·¦ä¸‹è§’çš„ Sourceï¼ˆæºï¼‰é¢æ¿ä¸­æ·»åŠ  Windows Captureï¼ŒæŠŠè§†é¢‘è¾“å…¥æºè®¾ç½®ä¸ºæŸä¸ªåº”ç”¨ç¨‹åºçª—å£ï¼Œç„¶åé€‰æ‹© [python.exe]: avatarify ç¨‹åºï¼Œç‚¹å‡» OKï¼Œå¯ä»¥è°ƒæ•´ä»¥ä¸‹å¤§å°ã€‚</li><li>å†åœ¨ Toolsï¼ˆå·¥å…·ï¼‰èœå•ä¸­é€‰æ‹© VirtualCamï¼ˆè™šæ‹Ÿæ‘„åƒå¤´ï¼‰ï¼Œé€‰æ‹© AutoStartï¼ˆè‡ªåŠ¨å¼€å¯ï¼‰ï¼Œè®¾ç½® Buffered Framesï¼ˆç¼“å†²ï¼‰ä¸º 0ï¼Œç„¶ç‚¹å‡»å¼€å§‹ã€‚ï¼ˆå¦‚æœ Tools èœå•æ²¡æœ‰ VirtualCamï¼Œçœ‹çœ‹ç•Œé¢å³ä¸‹è§’çš„ start recording é™„è¿‘æœ‰æ²¡æœ‰ start virtual camï¼‰ã€‚</li></ol><p>ç°åœ¨è™šæ‹Ÿæ‘„åƒå¤´å°±å‡†å¤‡å¥½äº†ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å®ç°æ¢è„¸-1"></a>å®ç°æ¢è„¸<a class="hash-link" href="#å®ç°æ¢è„¸-1" title="Direct link to heading">#</a></h3><p>æ¥ä¸‹æ¥å°±æ˜¯åœ¨æˆ‘ä»¬çš„è§†é¢‘é€šè¯å‰ç«¯é¡¹ç›®ä¸­ï¼Œä½¿ç”¨ CamTwist æˆ– OBS æä¾›çš„è™šæ‹Ÿæ‘„åƒå¤´äº†ã€‚æˆ‘ä»¬éœ€è¦æ˜ç¡®çŸ¥é“å®ƒä»¬çš„è®¾å¤‡ ID æ‰èƒ½æŒ‡å®šå…·ä½“ä½¿ç”¨å“ªä¸ªæ‘„åƒå¤´ã€‚
é¦–å…ˆä½¿ç”¨ Live Server æ‰“å¼€å‰ç«¯é¡¹ç›®çš„ index.html æ–‡ä»¶ï¼Œåœ¨è°·æ­Œå¼€å‘è€…å·¥å…·çš„ console ä¸­ï¼Œä½¿ç”¨ä¸‹é¢è¿™æ®µä»£ç æ‰“å°å‡ºè§†é¢‘è®¾å¤‡ä¿¡æ¯ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token dom variable" style="color:#36acaa">navigator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mediaDevices</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">enumerateDevices</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">devices</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  devices</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">device</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">kind</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;videoinput&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿™æ®µä»£ç å°±æ˜¯è®¿é—®æ‰€æœ‰åª’ä½“è®¾å¤‡ï¼Œç„¶åè·å–å…¶ä¸­çš„è§†é¢‘è®¾å¤‡å¹¶æ‰“å°å‡ºæ¥ï¼Œä»æ‰“å°ç»“æœé‡Œæ‰¾åˆ° label åŒ…å« CamTwist æˆ–è€… OBSï¼ˆè§†æ“ä½œç³»ç»Ÿè€Œå®šï¼‰çš„é‚£ä¸€é¡¹ï¼Œè®°å½• deviceId å±æ€§ã€‚
åœ¨ index.js æ–‡ä»¶ä¸­ï¼Œä¿å­˜ deviceId å€¼åˆ°ä¸€ä¸ªå¸¸é‡ä¸­ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> cameraId </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;982947417cf490bae44ffb6a837bddcb813704ee491dd85d9149c45389f5521b&quot;</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>åœ¨ä½¿ç”¨ <code>navigator.mediaDevices.getUserMedia()</code>Â  è·å–æ‘„åƒå¤´æ—¶ï¼Œé™¤äº†å¯ä»¥æŠŠ video è®¾ç½®ä¸º true ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æŠŠä»–çš„å€¼è®¾ç½®ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥æŒ‡å®šæ›´å¤šçš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æŠŠå®ƒå•ç‹¬å®šä¹‰å‡ºæ¥ï¼Œåœ¨é‡Œè¾¹ä½¿ç”¨ cameraId æŒ‡å®šè®¿é—®å“ªä¸ªæ‘„åƒå¤´ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> mediaConstrains </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  video</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    deviceId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      exact</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> cameraId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  audio</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>exact æ˜¯ç²¾ç¡®çš„ã€åªä½¿ç”¨æŒ‡å®š ID çš„æ‘„åƒå¤´ï¼Œä¸ä¼šä½¿ç”¨å…¶ä»–å¤‡é€‰çš„ã€‚
ç„¶ååœ¨è·å–è‡ªå·±æ‘„åƒå¤´è®¾å¤‡çš„éƒ¨åˆ†ï¼Œæ›¿æ¢æˆä¸Šè¾¹è¿™ä¸ªå¯¹è±¡ã€‚æˆ–è€…ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œä¹Ÿå¯ä»¥æŠŠæ‰€æœ‰çš„éƒ½æ›¿æ¢æ‰ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token dom variable" style="color:#36acaa">navigator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mediaDevices</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getUserMedia</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mediaConstrains</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token comment" style="color:#999988;font-style:italic">/* ... */</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å¥½äº†ï¼Œç°åœ¨å†è¯•è¯•è§†é¢‘é€šè¯ï¼Œæ˜¯ä¸æ˜¯æˆåŠŸçš„æ¢è„¸äº†å‘¢ï¼Ÿ
è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œå¯èƒ½æ˜¯å› ä¸º CamTwist è½¯ä»¶å’ŒçœŸæ­£çš„æ‘„åƒå¤´æœ‰å†²çªï¼Œé¡µé¢ä¼šä¸æ—¶çš„é‡æ–°åˆ·æ–°ï¼Œè¿™ä¸ªæš‚æ—¶è¿˜æ²¡æœ‰æ¯”è¾ƒå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚æœä½ æœ‰ç²¾åŠ›çš„è¯å¯ä»¥ç ”ç©¶ä¸€ä¸‹ã€‚
é™„ä¸Šæœ¬æ–‡çš„æºä»£ç ï¼š
<a href="https://github.com/zxuqian/code-examples/tree/master/webrtc/video-call-change-face" target="_blank" rel="noopener noreferrer">https://github.com/zxuqian/code-examples/tree/master/webrtc/video-call-change-face</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ€»ç»“"></a>æ€»ç»“<a class="hash-link" href="#æ€»ç»“" title="Direct link to heading">#</a></h2><p>è¿™ç¯‡æ•™ç¨‹æ‰€ç”¨åˆ°çš„æŠ€æœ¯éƒ½å¾ˆç®€å•ï¼Œåªæ˜¯é…ç½®æ¯”è¾ƒå¤æ‚ï¼Œæœ¬æ•™ç¨‹æä¾›äº†æ¢è„¸çš„åŸºæœ¬æ­¥éª¤ï¼Œå‰©ä¸‹çš„å¯ä»¥æ ¹æ®éœ€è¦ç»§ç»­è¿›è¡Œå®Œå–„ã€‚ç¤ºä¾‹ä¸­å®ç°çš„çš„æ˜¯ä¸€å¯¹ä¸€çš„è§†é¢‘é€šè¯ï¼Œä¸è¿‡åœ¨è¿™ä¸ªåŸºç¡€ä¸Šä¹Ÿå®Œå…¨å¯ä»¥å®ç°å¤šæ–¹è§†é¢‘ä¼šè®®ï¼Œåªéœ€è¦è°ƒæ•´ä¸€ä¸‹è§†é¢‘æ˜¾ç¤ºçš„æ ·å¼ï¼Œç„¶ååœ¨æœ‰æ–°äººåŠ è¿›æ¥æ—¶ï¼Œåˆ›å»ºç›¸åº”çš„ <code>&lt;video /&gt;</code>Â  æ ‡ç­¾ï¼Œå¹¶è¿½åŠ åˆ°ç°æœ‰çš„è§†é¢‘åˆ—è¡¨ä¸­å³å¯ã€‚ç°åœ¨æˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹è¿‡ç¨‹ï¼š</p><ul><li>ç¼–å†™å‰ç«¯ HTML/CSS é¡µé¢ç»“æ„å’Œæ ·å¼ï¼Œå¹¶å°è¯•åŠ è½½æ‘„åƒå¤´ã€‚</li><li>ç¼–å†™ç®€å•çš„åå°åº”ç”¨ï¼Œåˆ©ç”¨ epxress å’Œ peer å»ºç«‹åŸºäº WebRTC çš„è§†é¢‘é€šè¯åŸºç¡€ã€‚</li><li>å‰ç«¯åˆ©ç”¨ peer.js å‰ç«¯åº“è°ƒç”¨åå°ç”Ÿæˆç”¨æˆ· IDï¼Œå¹¶å‘¼å«ã€åº”ç­”è§†é¢‘é€šè¯ã€‚</li><li>é…ç½® Avatarify æ¢è„¸æœåŠ¡å™¨ç¨‹åºï¼Œåˆ©ç”¨äº‘ GPU æœåŠ¡æŠŠæ˜¾å¡è®¡ç®—ç›¸å…³éƒ¨åˆ†è½¬ç§»åˆ° GPU å®ä¾‹ä¸­ã€‚</li><li>å®‰è£… Avatarify å®¢æˆ·ç«¯ç¨‹åºå’Œè™šæ‹Ÿæ‘„åƒå¤´åº”ç”¨ï¼ŒæŠŠæ¢è„¸åçš„æ•°æ®ç”¨è™šæ‹Ÿæ‘„åƒå¤´å±•ç°å‡ºæ¥ã€‚</li><li>å‰ç«¯è·å–è™šæ‹Ÿæ‘„åƒå¤´ IDï¼Œåœ¨è§†é¢‘é€šè¯çš„æ—¶å€™ä½¿ç”¨æ­¤æ‘„åƒå¤´ã€‚</li></ul><p>å¦‚æœæœ‰å¸®åŠ©è¯·ç‚¹èµå¹¶åˆ†äº«ï¼Œæœ‰é—®é¢˜å¯ä»¥è¯„è®ºç•™è¨€ï¼Œæ„Ÿè°¢é˜…è¯»ï¼</p></section><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3487507367729662" data-ad-slot="4590671808" data-ad-format="auto" data-full-width-responsive="true"></ins></article><footer class="article__footer padding-top--md margin-top--lg margin-bottom--lg"></footer></div></div></div><nav class="pagination-nav docusaurus-mt-lg" aria-label="åšå®¢å¯¼èˆª"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/web-performance-optimization-image-lazy-loading"><div class="pagination-nav__sublabel">ä¸‹ä¸€ç¯‡</div><div class="pagination-nav__label">Â« Webæ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨å›¾ç‰‡æ‡’åŠ è½½æ¨è¿Ÿå±å¹•å¤–å›¾ç‰‡çš„åŠ è½½</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/css-font-display-intro"><div class="pagination-nav__sublabel">ä¸Šä¸€ç¯‡</div><div class="pagination-nav__label">Web æ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ CSS font-display æ§åˆ¶å­—ä½“åŠ è½½å’Œæ›¿æ¢ Â»</div></a></div></nav></main><div class="col col--2"><div class="sidebarContainer_1tQU"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ç¼–å†™é¡µé¢" class="table-of-contents__link">ç¼–å†™é¡µé¢</a><ul><li><a href="#html" class="table-of-contents__link">HTML</a></li><li><a href="#css" class="table-of-contents__link">CSS</a></li></ul></li><li><a href="#è®¿é—®æ‘„åƒå¤´" class="table-of-contents__link">è®¿é—®æ‘„åƒå¤´</a></li><li><a href="#ç¼–å†™åå°" class="table-of-contents__link">ç¼–å†™åå°</a></li><li><a href="#ç”Ÿæˆç”¨æˆ·-id" class="table-of-contents__link">ç”Ÿæˆç”¨æˆ· ID</a></li><li><a href="#å‘¼å«è§†é¢‘é€šè¯" class="table-of-contents__link">å‘¼å«è§†é¢‘é€šè¯</a></li><li><a href="#åº”ç­”è§†é¢‘é€šè¯" class="table-of-contents__link">åº”ç­”è§†é¢‘é€šè¯</a></li><li><a href="#å®ç°æ¢è„¸" class="table-of-contents__link">å®ç°æ¢è„¸</a><ul><li><a href="#è´­ä¹°æœåŠ¡å™¨" class="table-of-contents__link">è´­ä¹°æœåŠ¡å™¨</a></li><li><a href="#éƒ¨ç½²-avatarify" class="table-of-contents__link">éƒ¨ç½² Avatarify</a></li><li><a href="#å®‰è£…-avatarify-å®¢æˆ·ç«¯" class="table-of-contents__link">å®‰è£… Avatarify å®¢æˆ·ç«¯</a></li><li><a href="#å¯åŠ¨-avatarify-å®¢æˆ·ç«¯" class="table-of-contents__link">å¯åŠ¨ Avatarify å®¢æˆ·ç«¯</a></li><li><a href="#windows-å®‰è£…æ–¹æ³•" class="table-of-contents__link">Windows å®‰è£…æ–¹æ³•</a></li><li><a href="#å®ç°æ¢è„¸-1" class="table-of-contents__link">å®ç°æ¢è„¸</a></li></ul></li><li><a href="#æ€»ç»“" class="table-of-contents__link">æ€»ç»“</a></li></ul></div><section><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3487507367729662" data-ad-slot="2034513429" data-ad-format="auto" data-full-width-responsive="true"></ins></section></div></div></div></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">å­¦ä¹ </div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/videos">æŠ€æœ¯è§†é¢‘</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/css/css-tutorial-intro">CSS å®Œå…¨æŒ‡å—</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/resources">èµ„æºå¯¼èˆª</a></li></ul></div><div class="col footer__col"><div class="footer__title">ç¤¾äº¤åª’ä½“</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/qzyzz" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://space.bilibili.com/62491371" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Bilibili å“”å“©å“”å“©<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">å‹æƒ…é“¾æ¥</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/zxuqian" target="_blank" rel="noopener noreferrer" class="footer__link-item">å³°åå‰ç«¯å·¥ç¨‹å¸ˆ</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><p>Copyright Â© 2023 qzy Built with Docusaurus.</p><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="/img/creative-commons-license-icon.png"></a><br>æœ¬ç«™æ‰€æœ‰å†…å®¹éµå¾ª <a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh-Hans">CC BY-NC 4.0 åè®®</a>ï¼Œè½¬è½½é¡»æ³¨æ˜ç½²åå’Œå‡ºå¤„ï¼Œä¸”ä¸å¯ç”¨äºå•†ä¸šç”¨é€”ã€‚è‹¥ä¸å…¶ä»–åŒæ­¥å¹³å°åè®®å†²çªï¼Œä»¥æœ¬ç½‘ç«™ä¸ºå‡†ã€‚</div></div></div></footer></div>
<script src="/assets/js/runtime~main.66196b93.js"></script>
<script src="/assets/js/main.0b32cb3b.js"></script>
</body>
</html>