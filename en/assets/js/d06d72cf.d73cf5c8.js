(self.webpackChunkzxuqian_cn=self.webpackChunkzxuqian_cn||[]).push([[2251],{2122:function(e,t,n){"use strict";function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}n.d(t,{Z:function(){return a}})},9756:function(e,t,n){"use strict";function a(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}n.d(t,{Z:function(){return a}})},3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return d},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),o=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=o(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),u=o(n),m=r,k=u["".concat(s,".").concat(m)]||u[m]||c[m]||i;return n?a.createElement(k,l(l({ref:t},d),{},{components:n})):a.createElement(k,l({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=u;var p={};for(var s in t)hasOwnProperty.call(t,s)&&(p[s]=t[s]);p.originalType=e,p.mdxType="string"==typeof e?e:r,l[1]=p;for(var o=2;o<i;o++)l[o]=n[o];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},3322:function(e,t,n){"use strict";var a=n(2122),r=n(9756),i=n(7294);t.Z=function(e){var t=e.src,n=e.webmSrc,l=(0,r.Z)(e,["src","webmSrc"]);return i.createElement("video",(0,a.Z)({autoPlay:!0,loop:!0,muted:!0,playsInline:!0},l),n&&i.createElement("source",{src:n,type:"video/webm"}),i.createElement("source",{src:t,type:"video/mp4"}))}},2378:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return p},contentTitle:function(){return s},metadata:function(){return o},toc:function(){return d},default:function(){return u}});var a=n(2122),r=n(9756),i=(n(7294),n(3905)),l=n(3322),p={slug:"webrtc-avatarify-face-swap-tutorial",title:"\u5b9e\u73b0\u524d\u7aef\u7f51\u9875 WebRTC \u89c6\u9891\u901a\u8bdd\u4ee5\u53ca\u6362\u8138\u7279\u6548",author:"\u5cf0\u534e",author_title:"\u524d\u7aef\u5de5\u7a0b\u5e08 / B\u7ad9UP\u4e3b",author_url:"https://github.com/zxuqian",author_image_url:"https://tvax3.sinaimg.cn/crop.0.0.1080.1080.180/b2745d44ly8g8s4muqeggj20u00u0n0k.jpg?KID=imgbed,tva&Expires=1582389585&ssig=EvXmyu%2FXsX",description:"\u56e0\u4e3a\u75ab\u60c5\u7684\u539f\u56e0\uff0c\u7ebf\u4e0a\u89c6\u9891\u4f1a\u8bae\u8f6f\u4ef6\u5f02\u519b\u7a81\u8d77\uff0c\u6210\u4e3a\u4e86\u5728\u5bb6\u529e\u516c\u7684\u4e3b\u8981\u6c9f\u901a\u6e20\u9053\u3002\u800c\u6700\u8fd1\u6296\u97f3\u4e0a\u201c\u8682\u8681\u5440\u563f\u201d\u6076\u641e\u6362\u8138\u7684\u5c0f\u89c6\u9891\u4e5f\u7a81\u7136\u706b\u4e86\u8d77\u6765\uff0c\u90a3\u6211\u5c31\u60f3\u4e86\u60f3\u80fd\u4e0d\u80fd\u5728\u89c6\u9891\u4f1a\u8bae\u7684\u65f6\u5019\u6362\u5f20\u8138\u6d3b\u8dc3\u4e0b\u6c14\u6c1b\uff1f",tags:["\u524d\u7aef","WebRTC","avatarify"],activityId:"501899252469610680"},s=void 0,o={permalink:"/en/webrtc-avatarify-face-swap-tutorial",source:"@site/blog/2021-03-14-webrtc-avatarify-face-swap-tutorial.md",title:"\u5b9e\u73b0\u524d\u7aef\u7f51\u9875 WebRTC \u89c6\u9891\u901a\u8bdd\u4ee5\u53ca\u6362\u8138\u7279\u6548",description:"\u56e0\u4e3a\u75ab\u60c5\u7684\u539f\u56e0\uff0c\u7ebf\u4e0a\u89c6\u9891\u4f1a\u8bae\u8f6f\u4ef6\u5f02\u519b\u7a81\u8d77\uff0c\u6210\u4e3a\u4e86\u5728\u5bb6\u529e\u516c\u7684\u4e3b\u8981\u6c9f\u901a\u6e20\u9053\u3002\u800c\u6700\u8fd1\u6296\u97f3\u4e0a\u201c\u8682\u8681\u5440\u563f\u201d\u6076\u641e\u6362\u8138\u7684\u5c0f\u89c6\u9891\u4e5f\u7a81\u7136\u706b\u4e86\u8d77\u6765\uff0c\u90a3\u6211\u5c31\u60f3\u4e86\u60f3\u80fd\u4e0d\u80fd\u5728\u89c6\u9891\u4f1a\u8bae\u7684\u65f6\u5019\u6362\u5f20\u8138\u6d3b\u8dc3\u4e0b\u6c14\u6c1b\uff1f",date:"2021-03-14T00:00:00.000Z",formattedDate:"March 14, 2021",tags:[{label:"\u524d\u7aef",permalink:"/en/tags/\u524d\u7aef"},{label:"WebRTC",permalink:"/en/tags/web-rtc"},{label:"avatarify",permalink:"/en/tags/avatarify"}],readingTime:7.9,truncated:!0,prevItem:{title:"Web\u6027\u80fd\u4f18\u5316\uff1a\u4f7f\u7528\u56fe\u7247\u61d2\u52a0\u8f7d\u63a8\u8fdf\u5c4f\u5e55\u5916\u56fe\u7247\u7684\u52a0\u8f7d",permalink:"/en/web-performance-optimization-image-lazy-loading"},nextItem:{title:"Web \u6027\u80fd\u4f18\u5316\uff1a\u4f7f\u7528 CSS font-display \u63a7\u5236\u5b57\u4f53\u52a0\u8f7d\u548c\u66ff\u6362",permalink:"/en/css-font-display-intro"}},d=[{value:"\u7f16\u5199\u9875\u9762",id:"\u7f16\u5199\u9875\u9762",children:[{value:"HTML",id:"html",children:[]},{value:"CSS",id:"css",children:[]}]},{value:"\u8bbf\u95ee\u6444\u50cf\u5934",id:"\u8bbf\u95ee\u6444\u50cf\u5934",children:[]},{value:"\u7f16\u5199\u540e\u53f0",id:"\u7f16\u5199\u540e\u53f0",children:[]},{value:"\u751f\u6210\u7528\u6237 ID",id:"\u751f\u6210\u7528\u6237-id",children:[]},{value:"\u547c\u53eb\u89c6\u9891\u901a\u8bdd",id:"\u547c\u53eb\u89c6\u9891\u901a\u8bdd",children:[]},{value:"\u5e94\u7b54\u89c6\u9891\u901a\u8bdd",id:"\u5e94\u7b54\u89c6\u9891\u901a\u8bdd",children:[]},{value:"\u5b9e\u73b0\u6362\u8138",id:"\u5b9e\u73b0\u6362\u8138",children:[{value:"\u8d2d\u4e70\u670d\u52a1\u5668",id:"\u8d2d\u4e70\u670d\u52a1\u5668",children:[]},{value:"\u90e8\u7f72 Avatarify",id:"\u90e8\u7f72-avatarify",children:[]},{value:"\u5b89\u88c5 Avatarify \u5ba2\u6237\u7aef",id:"\u5b89\u88c5-avatarify-\u5ba2\u6237\u7aef",children:[]},{value:"\u542f\u52a8 Avatarify \u5ba2\u6237\u7aef",id:"\u542f\u52a8-avatarify-\u5ba2\u6237\u7aef",children:[]},{value:"Windows \u5b89\u88c5\u65b9\u6cd5",id:"windows-\u5b89\u88c5\u65b9\u6cd5",children:[]},{value:"\u5b9e\u73b0\u6362\u8138",id:"\u5b9e\u73b0\u6362\u8138-1",children:[]}]},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",children:[]}],c={toc:d};function u(e){var t=e.components,p=(0,r.Z)(e,["components"]);return(0,i.kt)("wrapper",(0,a.Z)({},c,p,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"\u56e0\u4e3a\u75ab\u60c5\u7684\u539f\u56e0\uff0c\u7ebf\u4e0a\u89c6\u9891\u4f1a\u8bae\u8f6f\u4ef6\u5f02\u519b\u7a81\u8d77\uff0c\u6210\u4e3a\u4e86\u5728\u5bb6\u529e\u516c\u7684\u4e3b\u8981\u6c9f\u901a\u6e20\u9053\u3002\u800c\u6700\u8fd1\u6296\u97f3\u4e0a\u201c\u8682\u8681\u5440\u563f\u201d\u6076\u641e\u6362\u8138\u7684\u5c0f\u89c6\u9891\u4e5f\u7a81\u7136\u706b\u4e86\u8d77\u6765\uff0c\u90a3\u6211\u5c31\u60f3\u4e86\u60f3\u80fd\u4e0d\u80fd\u5728\u89c6\u9891\u4f1a\u8bae\u7684\u65f6\u5019\u6362\u5f20\u8138\u6d3b\u8dc3\u4e0b\u6c14\u6c1b\uff1f\u5728 Github \u4e0a\u4e00\u756a\u641c\u5bfb\u4e4b\u540e\u53d1\u73b0\u8fd8\u771f\u6709\u529e\u6cd5\uff0c\u6709\u4e00\u4e2a\u5f00\u6e90\u7684 Python \u4eba\u5de5\u667a\u80fd\u6362\u8138\u7684\u5e93\uff0c\u90a3\u6b63\u597d\u8d81\u7740\u8fd9\u4e2a\u673a\u4f1a\u7814\u7a76\u4e00\u4e0b\u524d\u7aef WebRTC \u5b9e\u73b0\u89c6\u9891\u901a\u8bdd\u529f\u80fd\uff0c\u5916\u52a0\u6362\u8138\u64cd\u4f5c\u3002\u5148\u770b\u4e00\u4e0b\u6548\u679c\u5427\uff1a"),(0,i.kt)(l.Z,{src:n(3506).Z,mdxType:"Video"}),(0,i.kt)("p",null,"\u56e0\u4e3a\u6709\u6d89\u53ca\u5230\u4e00\u70b9\u70b9\u7684\u540e\u53f0\uff0c\u6240\u4ee5\u9879\u76ee\u5206\u6210\u4e86\u4e24\u90e8\u5206\uff0c\u4e00\u4e2a\u662f\u7528\u4e8e\u5b58\u653e\u524d\u7aef\u4ee3\u7801\u7684 frontend \u9879\u76ee\u548c\u5b58\u653e\u540e\u7aef\u4ee3\u7801\u7684 backend \u9879\u76ee\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"\u9879\u76ee\u6839\u76ee\u5f55\n  |-- backend\n  |-- frontend\n")),(0,i.kt)("p",null,"\u53e6\u5916\u8fd9\u4e2a\u89c6\u9891\u9700\u8981\u7535\u8111\u4e0a\u6709\u6444\u50cf\u5934\uff0c\u6ca1\u6709\u7684\u8bdd\u53ef\u4ee5\u60f3\u529e\u6cd5\u628a\u624b\u673a\u5f53\u4f5c\u7535\u8111\u7684\u6444\u50cf\u5934\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6ce8\u610f\uff1a\u672c\u6559\u7a0b\u4e2d\u7684\u4ee3\u7801\u4ec5\u4f9b\u5c55\u793a AI \u6362\u8138\u6280\u672f\u7684\u5e94\u7528\uff0c\u4e0d\u53ef\u4ee5\u7528\u4e8e\u83b7\u53d6\u5176\u4ed6\u4eba\u9690\u79c1\u6216\u5176\u4ed6\u4efb\u4f55\u975e\u6cd5\u76ee\u7684\u3002")),(0,i.kt)("h2",{id:"\u7f16\u5199\u9875\u9762"},"\u7f16\u5199\u9875\u9762"),(0,i.kt)("p",null,"\u56e0\u4e3a\u662f\u524d\u7aef\u5b9e\u73b0\uff0c\u9996\u5148\u80af\u5b9a\u662f\u7f16\u5199\u9875\u9762\u3002\u8fd9\u4e2a\u9875\u9762\u6bd4\u8f83\u7b80\u5355\uff0c\u5c31\u662f\u4e00\u4e2a\u89c6\u9891\u7ec4\u4ef6\u3001\u663e\u793a\u7528\u6237 ID \u7684\u6587\u672c\u3001\u547c\u53eb\u5bf9\u65b9\u89c6\u9891\u7684\u8f93\u5165\u6846\u548c\u6309\u94ae\uff0c\u89c6\u9891\u7ec4\u4ef6\u9ed8\u8ba4\u663e\u793a\u81ea\u5df1\u7684\u89c6\u9891\uff0c\u5f53\u89c6\u9891\u63a5\u901a\u4e4b\u540e\u5c31\u4f1a\u663e\u793a\u5bf9\u65b9\u7684\u89c6\u9891\uff0c\u800c\u81ea\u5df1\u7684\u89c6\u9891\u4f1a\u7f29\u5c0f\u5230\u53f3\u4e0a\u89d2\u3002"),(0,i.kt)("h3",{id:"html"},"HTML"),(0,i.kt)("p",null,"\u5728 frontend \u76ee\u5f55\u4e0b\u65b0\u5efa index.html\u3001style.css \u548c index.js \u6587\u4ef6\u3002\u9996\u5148\u770b\u4e00\u4e0b HTML \u7ed3\u6784\uff0cindex.html \u4e2d\u4e3b\u8981\u7684\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- frontend/index.html --\x3e\n<head>\n  \x3c!-- \u5176\u4ed6\u4ee3\u7801 --\x3e\n  <link rel="stylesheet" href="style.css" />\n</head>\n<body>\n  <main>\n    <div id="container">\n      <div class="videos">\n        <video id="myVideo" class="videoSize" autoplay></video>\n        <video id="peerVideo" class="videoSize" autoplay></video>\n      </div>\n      <p id="idText"></p>\n      <div class="call">\n        <input type="text" id="peerIdInput" placeholder="\u8bf7\u8f93\u5165\u5bf9\u65b9 id" />\n        <button id="joinBtn">\u89c6\u9891\u901a\u8bdd</button>\n      </div>\n    </div>\n  </main>\n  <script src="index.js"><\/script>\n</body>\n')),(0,i.kt)("p",null,"\u6bcf\u4e2a\u6807\u7b7e\u7684\u4f5c\u7528\u662f\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"<main />"),"\xa0 \u7528\u4e8e\u8bbe\u7f6e\u9875\u9762\u80cc\u666f\uff0c\u628a\u6240\u6709\u7ec4\u4ef6\u5c45\u4e2d\u5bf9\u9f50\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'<div class="videos">'),"\xa0 \u91cc\u8fb9\u5206\u522b\u653e\u4e86\u663e\u793a\u81ea\u5df1\u89c6\u9891 ",(0,i.kt)("inlineCode",{parentName:"li"},"#myVideo"),"\xa0 \u548c\u5bf9\u65b9\u89c6\u9891 ",(0,i.kt)("inlineCode",{parentName:"li"},"#peerVideo"),"\xa0 \u7684 ",(0,i.kt)("inlineCode",{parentName:"li"},"<video />"),"\xa0 \u7ec4\u4ef6\uff0c\u5e76\u8bbe\u7f6e\u4e3a\u81ea\u52a8\u64ad\u653e\uff0c\u4ee5\u4fbf\u4e8e\u5728\u52a0\u8f7d\u6444\u50cf\u5934\u540e\u7acb\u523b\u5f00\u59cb\u64ad\u653e\u753b\u9762\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'<p id="idText">')," \u5728\u9875\u9762\u6253\u5f00\u65f6\u663e\u793a\u81ea\u5df1\u7684\u7528\u6237 ID\uff0c\u76f8\u5f53\u4e8e\u662f\u7535\u8bdd\u53f7\u7801\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'<div class="call">'),"\xa0 \u91cc\u662f\u8f93\u5165\u5bf9\u65b9 ID \u7684\u6587\u672c\u6846 ",(0,i.kt)("inlineCode",{parentName:"li"},"#peerIdInput"),"\xa0 \u548c\u547c\u53eb\u6309\u94ae ",(0,i.kt)("inlineCode",{parentName:"li"},"#joinBtn"),"\xa0\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u6700\u540e\u5728 ",(0,i.kt)("inlineCode",{parentName:"li"},"<head />"),"\xa0 \u4e2d\u5f15\u5165\u6837\u5f0f\u6587\u4ef6 style.css\uff0c\u5728 ",(0,i.kt)("inlineCode",{parentName:"li"},"<body />"),"\xa0 \u7ed3\u675f\u524d\u5f15\u5165 index.js\u3002\u6211\u4eec\u5c06\u4e3b\u8981\u5728 index.js \u4e2d\u7f16\u5199\u4ee3\u7801\u3002")),(0,i.kt)("h3",{id:"css"},"CSS"),(0,i.kt)("p",null,"css \u7684\u4ee3\u7801\u90fd\u6bd4\u8f83\u7b80\u5355\uff0c\u57fa\u672c\u5c31\u662f\u8bbe\u7f6e\u4e00\u4e0b\u6837\u5f0f\uff0c\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u4e0b\u91cd\u8981\u7684\u90e8\u5206\uff0c\u5269\u4f59\u7684\u53ef\u4ee5\u5728\u6e90\u4ee3\u7801\u4e2d\u67e5\u770b\u3002\u56e0\u4e3a\u81ea\u5df1\u7684\u89c6\u9891\u8981\u5728\u89c6\u9891\u63a5\u901a\u65f6\u79fb\u52a8\u5230\u53f3\u4e0a\u89d2\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u628a ",(0,i.kt)("inlineCode",{parentName:"p"},'<div class="videos"> ')," \u5bb9\u5668\u8bbe\u7f6e\u4e3a\u76f8\u5bf9\u5b9a\u4f4d\uff0c\u628a\u6211\u7684\u89c6\u9891\u548c\u5bf9\u65b9\u7684\u89c6\u9891\u8bbe\u7f6e\u6210\u4e00\u6837\u7684\u5bbd\u9ad8\uff0c\u7136\u540e\u5148\u9690\u85cf\u5bf9\u65b9\u89c6\u9891\uff0c\u5f53\u89c6\u9891\u63a5\u901a\u65f6\uff0c\u5229\u7528 JavaScript \u52a0\u4e0a\u63a5\u901a\u540e\uff0c\u6211\u7684\u89c6\u9891\u7684\u6837\u5f0f\uff0c\u628a\u6211\u7684\u89c6\u9891\u8bbe\u7f6e\u4e3a\u7edd\u5bf9\u5b9a\u4f4d\uff0c\u5bbd\u9ad8\u8c03\u5c0f\uff0c\u653e\u5230\u53f3\u4e0a\u89d2\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-css"},"/* frontend/style.css */\nvideos {\n  position: relative;\n}\n\n.videoSize {\n  width: 500px;\n  height: 600px;\n  object-fit: cover; /* \u8ba9\u89c6\u9891\u6309\u6bd4\u4f8b\u5360\u6ee1\u6574\u4e2a\u7a7a\u95f4 */\n}\n\n.rightTop {\n  /* \u4ee5\u4e0b\u662f\u901a\u8bdd\u4e2d\u7684\u6837\u5f0f */\n  position: absolute;\n  width: 150px;\n  height: 180px;\n  right: 0;\n  top: 0;\n}\n\n#peerVideo {\n  display: none;\n}\n")),(0,i.kt)("p",null,"\u5176\u4ed6\u7ec4\u4ef6\u57fa\u672c\u53ea\u662f\u8bbe\u7f6e\u4e86\u4e0b Grid \u5e03\u5c40\u3001\u5bbd\u9ad8\u3001\u5927\u5c0f\u3001\u9634\u5f71\u3001\u80cc\u666f\u3001\u5b57\u4f53\uff0c\u6ca1\u6709\u4ec0\u4e48\u7279\u6b8a\u7684\uff0c\u53ef\u4ee5\u76f4\u63a5\u67e5\u770b\u6e90\u4ee3\u7801\u3002\u6837\u5f0f\u4e2d\u6240\u7528\u5230\u7684\u56fe\u6807\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"frontend/icons"),"\xa0 \u76ee\u5f55\u4e0b\u3002"),(0,i.kt)("h2",{id:"\u8bbf\u95ee\u6444\u50cf\u5934"},"\u8bbf\u95ee\u6444\u50cf\u5934"),(0,i.kt)("p",null,"\u63a5\u4e0b\u6765\u6211\u4eec\u5148\u719f\u6089\u4e00\u4e0b\u8bbf\u95ee\u6444\u50cf\u5934\u7684\u4ee3\u7801\u3002\u5728 JavaScript \u4e2d\u8bbf\u95ee\u7528\u6237\u7684\u6444\u50cf\u5934\u4e3b\u8981\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"navigator.mediaDevices.getUserMedia()")," \u65b9\u6cd5\uff0c\xa0 \u5b83\u63a5\u6536\u4e00\u4e2a\u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\uff0c\u7528\u4e8e\u6307\u5b9a\u8981\u83b7\u53d6\u7684\u8bbe\u5907\uff0c\u4f8b\u5982\u89c6\u9891\u6216\u97f3\u9891\uff0c\u7136\u540e\u8fd4\u56de\u4e00\u4e2a Promise\uff0c\u5728 Promise \u5b8c\u6210\u4e4b\u540e\u5b83\u4f1a\u4f20\u9012\u7ed9\u6211\u4eec\u4e00\u4e2a Stream \u6d41\uff0c\u6211\u4eec\u628a\u5b83\u653e\u5230 ",(0,i.kt)("inlineCode",{parentName:"p"},"<video />"),"\xa0 \u6807\u7b7e\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"srcObject"),"\xa0 \u5c5e\u6027\u4e2d\u5c31\u53ef\u4ee5\u4e86\uff0c\u662f\u4e0d\u662f\u5f88\u7b80\u5355\uff1f\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'// frontend/index.js\nconst myVideo = document.getElementById("myVideo");\n\nnavigator.mediaDevices\n  .getUserMedia({ video: true, audio: true })\n  .then((stream) => {\n    myVideo.srcObject = stream;\n  });\n')),(0,i.kt)("p",null,"\u5728\u8fd9\u6bb5\u4ee3\u7801\u4e2d\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u4e86 ",(0,i.kt)("inlineCode",{parentName:"li"},"#myVideo"),"\xa0 \u8fd9\u4e2a ",(0,i.kt)("inlineCode",{parentName:"li"},"<video />"),"\xa0 \u7ec4\u4ef6\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"li"},"navigator.mediaDevices.getUserMedia()")," \u5e76\u7ed9\u5b83\u4f20\u9012\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5bf9\u8c61\u7684 video \u548c audio \u5c5e\u6027\u90fd\u8bbe\u7f6e\u4e3a\u4e86 true\uff0c\u8868\u793a\u8981\u8bbf\u95ee\u6444\u50cf\u5934\u548c\u97f3\u9891\u8bbe\u5907\u3002")),(0,i.kt)("p",null,"\u8fd9\u65f6\uff0c\u4f7f\u7528 VS Code \u7684 Live Server \u63d2\u4ef6\u8fd0\u884c\u9879\u76ee\uff08\u6ca1\u6709\u7684\u8bdd\u5b89\u88c5\u4e00\u4e0b\uff0c\u5f88\u7b80\u5355\uff09\uff0c\u5728 index.html \u6587\u4ef6\u91cc\u53f3\u51fb\uff0c\u9009\u62e9 Open with Live Server\uff0c\u6253\u5f00\u4e4b\u540e\uff0c\u6d4f\u89c8\u5668\u53ef\u80fd\u4f1a\u63d0\u793a\u6b64\u7f51\u7ad9\u9700\u8981\u8bbf\u95ee\u6444\u50cf\u5934\u548c\u97f3\u9891\u8bbe\u5907\uff0c\u70b9\u51fb\u5141\u8bb8\uff0c\u5c31\u80fd\u770b\u5230\u81ea\u5df1\u7684\u89c6\u9891\u4e86\u3002"),(0,i.kt)("h2",{id:"\u7f16\u5199\u540e\u53f0"},"\u7f16\u5199\u540e\u53f0"),(0,i.kt)("p",null,"\u8981\u5b9e\u73b0\u89c6\u9891\u901a\u8bdd\uff0c\u9700\u8981\u4f7f\u7528 WebRTC \u6280\u672f\uff0c\u8fd9\u4e2a\u6280\u672f\u7275\u626f\u7684\u6982\u5ff5\u548c API \u8fc7\u4e8e\u5e9e\u5927\u548c\u590d\u6742\uff0c\u4e0d\u8fc7\u6709\u5f00\u6e90\u7684\u5e93\u6765\u5e2e\u6211\u4eec\u7b80\u5316\u4e86 WebRTC \u7684\u64cd\u4f5c\uff0c\u8fd9\u91cc\u4f7f\u7528\u4e00\u4e2a\u53eb\u505a Peer.js \u7684\u5e93\uff0c\u5b83\u5c01\u88c5\u4e86 WebRTC \u6742\u4e71\u7684 API\uff0c\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u3001\u53ef\u914d\u7f6e\u7684\u3001\u6613\u4e8e\u4f7f\u7528\u7684 API\u3002\n",(0,i.kt)("a",{parentName:"p",href:"https://peerjs.com/"},"https://peerjs.com/"),"\n\u6211\u4eec\u5c06\u4f1a\u901a\u8fc7\u628a Peer \u9644\u52a0\u5230 Express.js \u670d\u52a1\u5668\u4e0a\uff0c\u6765\u751f\u6210\u7528\u6237 ID \u5e76\u7ba1\u7406 WebRTC \u8fde\u63a5\u3002\u9996\u5148\u5728 backend \u76ee\u5f55\u4e0b\u8fd0\u884c\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm init -y\n# \u6216\nyarn init -y\n")),(0,i.kt)("p",null,"\u63a5\u7740\u521d\u59cb\u5316\u4e00\u4e2a node.js \u9879\u76ee\uff0c\u4f7f\u7528 npm \u6216 yarn \u5b89\u88c5 peer \u548c express \u4f9d\u8d56\uff0c\u56e0\u4e3a\u60f3\u5728\u6539\u52a8\u4ee3\u7801\u65f6\u81ea\u52a8\u91cd\u542f\u670d\u52a1\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u518d\u5b89\u88c5\u4e00\u4e2a nodemon \u4f9d\u8d56\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add peer express nodemon\n# \u6216\nnpm install --save peer express nodemon\n")),(0,i.kt)("p",null,"\u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\u65b0\u5efa\u4e00\u4e2a server.js \u6587\u4ef6\uff0c\u6574\u4e2a\u540e\u53f0\u670d\u52a1\u6211\u4eec\u5c31\u53ea\u9700\u8981\u8fd9\u4e00\u4e2a\u6587\u4ef6\uff0c\u90fd\u662f\u4e00\u4e9b\u7b80\u5355\u7684\u521d\u59cb\u5316\u4ee3\u7801\uff0c\u5b83\u91cc\u8fb9\u7684\u5185\u5bb9\u662f\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'const express = require("express");\nconst { ExpressPeerServer } = require("peer");\n\nconst app = express();\n\nconst server = app.listen(3000);\n\nconst peerServer = ExpressPeerServer(server, {\n  debug: true,\n  path: "/",\n});\n\napp.use("/video", peerServer);\n')),(0,i.kt)("p",null,"\u8fd9\u4e9b\u4ee3\u7801\u7684\u542b\u4e49\u662f\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5bfc\u5165 express \u5e93\uff0c\u5e76\u4ece peer \u5e93\u4e2d\u5bfc\u5165\u4e0e express \u8fdb\u884c\u7ed3\u5408\u7684 ExpressPeerServer\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u521b\u5efa express \u5b9e\u4f8b ",(0,i.kt)("inlineCode",{parentName:"li"},"app"),"\xa0\uff0c\u5e76\u76d1\u542c ",(0,i.kt)("inlineCode",{parentName:"li"},"3000"),"\xa0 \u7aef\u53e3\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u628a ExpressPeerServer \u6302\u8f7d\u5230 express \u4e2d\uff0c\u8bbe\u7f6e ",(0,i.kt)("inlineCode",{parentName:"li"},"debug"),"\xa0 \u5f00\u53d1\u6a21\u5f0f\u4e3a true\uff0c\u8fd9\u6837\u6709\u66f4\u597d\u7684\u9519\u8bef\u63d0\u793a\u3002\u8def\u5f84\u4e3a\u6839\u76ee\u5f55\u3002"),(0,i.kt)("li",{parentName:"ul"},"ExpressPeerServer \u6302\u8f7d\u4e4b\u540e\u4f1a\u8fd4\u56de\u4e00\u4e2a express \u7684\u63a7\u5236\u5668\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u628a\u8fd4\u56de\u7684\u63a7\u5236\u5668\u6302\u8f7d\u5230 ",(0,i.kt)("inlineCode",{parentName:"li"},"/video"),"\xa0 \u8def\u5f84\u4e0b\uff0c\u8fd9\u6837 ",(0,i.kt)("inlineCode",{parentName:"li"},"/video"),"\xa0 \u8def\u5f84\u5c31\u662f\u4e3b\u8981\u7684\u3001peer.js \u63d0\u4f9b\u7684 WebRTC \u901a\u4fe1\u8def\u5f84\u3002")),(0,i.kt)("p",null,"\u7136\u540e\u4fee\u6539\u4e00\u4e0b package.json \u6587\u4ef6\uff0c\u6dfb\u52a0\u4e00\u4e2a ",(0,i.kt)("inlineCode",{parentName:"p"},"script"),"\xa0 \u914d\u7f6e\u9879\uff0c\u91cc\u8fb9\u5b9a\u4e49 ",(0,i.kt)("inlineCode",{parentName:"p"},"start"),"\xa0 \u547d\u4ee4\u503c\u4e3a ",(0,i.kt)("inlineCode",{parentName:"p"},"nodemon server.js"),"\xa0\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'  "scripts": {\n    "start": "nodemon server.js"\n  },\n')),(0,i.kt)("p",null,"\u8fd9\u6837\u4f7f\u7528 nodemon \u8fd0\u884c server.js \u6587\u4ef6\u540e\uff0c\u5982\u679c server.js \u4e2d\u7684\u5185\u5bb9\u53d1\u751f\u53d8\u5316\uff0c\u5b83\u4f1a\u81ea\u52a8\u5e2e\u52a9\u6211\u4eec\u91cd\u542f\u670d\u52a1\u5668\u3002\n\u6211\u4eec\u73b0\u5728\u6765\u8fd0\u884c\u4e00\u4e0b ",(0,i.kt)("inlineCode",{parentName:"p"},"yarn start"),"\xa0 \u6216\u8005 ",(0,i.kt)("inlineCode",{parentName:"p"},"npm start"),"\xa0\uff0c\u770b\u5230\u547d\u4ee4\u884c\u63d0\u793a ",(0,i.kt)("inlineCode",{parentName:"p"},"[nodemon] starting node server.js"),"\xa0 \u5c31\u7b97\u542f\u52a8\u6210\u529f\u4e86\uff0c\u6211\u4eec\u8bbf\u95ee\u4e00\u4e0b ",(0,i.kt)("inlineCode",{parentName:"p"},"http://localhost:3000/video"),"\xa0\xa0\uff0c\u770b\u5230\u4e0b\u65b9\u8f93\u51fa\u7ed3\u679c\u5c31\u8bf4\u660e peer \u4e5f\u52a0\u8f7d\u6210\u529f\u4e86\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "PeerJS Server",\n  "description": "A server side element to broker connections between PeerJS clients.",\n  "website": "https://peerjs.com/"\n}\n')),(0,i.kt)("p",null,"\u540e\u7aef\u4ee3\u7801\u5230\u8fd9\u91cc\u5c31\u7f16\u5199\u5b8c\u6210\u4e86\u3002\u4e0b\u4e00\u6b65\u5c31\u662f\u5728\u524d\u7aef\u9875\u9762\u4e2d\u8c03\u7528 Peer \u76f8\u5173\u7684 api\uff0c\u5e76\u5efa\u7acb\u89c6\u9891\u901a\u8bdd\u3002"),(0,i.kt)("h2",{id:"\u751f\u6210\u7528\u6237-id"},"\u751f\u6210\u7528\u6237 ID"),(0,i.kt)("p",null,"\u5728\u524d\u7aef\u4e2d\u8c03\u7528\u540e\u7aef Peer \u670d\u52a1\u53ef\u4ee5\u4f7f\u7528 Peer.js \u5b98\u65b9\u7684\u524d\u7aef\u5e93\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 cdn \u5f62\u5f0f\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<script src="https://unpkg.com/peerjs@1.3.1/dist/peerjs.min.js"><\/script>\n')),(0,i.kt)("p",null,"\u4e5f\u53ef\u4ee5\u6253\u5f00\u4e0a\u8fb9 src \u4e2d\u7684\u7f51\u5740\uff0c\u628a\u6587\u4ef6\u4fdd\u5b58\u5230\u672c\u5730\uff0c\u6216\u8005\u5728 Github \u4e0a\u4e0b\u8f7d\uff1a\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/peers/peerjs/blob/master/dist/peerjs.min.js"},"https://github.com/peers/peerjs/blob/master/dist/peerjs.min.js"),"\n\u4e0b\u8f7d\u5b8c\u6210\u4e4b\u540e\u628a\u5b83\u653e\u5230 ",(0,i.kt)("inlineCode",{parentName:"p"},"frontend/peer"),"\xa0 \u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u5728 index.html \u4e2d\uff0c\u5728\u5f15\u5165 index.js \u7684\u4e0a\u65b9\uff0c\u5f15\u5165 peerjs\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<script src="peer/peerjs.min.js"><\/script>\n<script src="index.js"><\/script>\n')),(0,i.kt)("p",null,"\u63a5\u4e0b\u6765\u6253\u5f00 index.js \u6587\u4ef6\uff0c\u5efa\u7acb\u4e0e\u540e\u53f0 peer \u670d\u52a1\u7684\u8fde\u63a5\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'const peer = new Peer({\n  host: "localhost",\n  port: "3000",\n  path: "/video",\n});\n')),(0,i.kt)("p",null,"\u8fd9\u91cc\u76f4\u63a5\u4f7f\u7528 peer.js \u524d\u7aef\u5e93\u5bfc\u51fa\u7684\u6784\u9020\u51fd\u6570 Peer()\uff0c\u5b83\u63a5\u6536\u4e00\u4e2a\u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\uff0c\u8fd9\u91cc\u5c31\u5206\u522b\u628a\u540e\u53f0\u670d\u52a1\u7684 host\u3001port \u548c path \u4f20\u9012\u8fdb\u53bb\u5c31\u53ef\u4ee5\u4e86\uff0c\u5b83\u4f1a\u8fd4\u56de peer \u5b9e\u4f8b\uff0c\u540e\u7eed\u6709\u5173\u89c6\u9891\u901a\u8bdd\u7684\u64cd\u4f5c\u5c31\u4e3b\u8981\u4f7f\u7528\u5b83\u6765\u5b9e\u73b0\u3002\n\u5f53\u6210\u529f\u7684\u8fde\u63a5\u5230\u540e\u53f0\u670d\u52a1\u4e4b\u540e\uff0c\u6211\u4eec\u9996\u5148\u7ed9\u81ea\u5df1\u751f\u6210\u4e00\u4e2a\u552f\u4e00\u7684\u7528\u6237 ID\uff0c\u5c31\u7b49\u540c\u4e8e\u662f\u4e00\u4e2a\u7535\u8bdd\u53f7\u7801\uff0c\u90a3\u4e48\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u76d1\u542c peer \u7684 ",(0,i.kt)("strong",{parentName:"p"},"open"),"\xa0 \u4e8b\u4ef6\uff0c\u5f53\u8fde\u63a5\u6253\u5f00\u540e\uff0c\u4f1a\u628a\u751f\u6210\u7684\u7528\u6237 ID \u8fd4\u56de\u5230\u4e8b\u4ef6\u5904\u7406\u56de\u8c03\u51fd\u6570\u4e2d\uff0c\u7136\u540e\u6211\u4eec\u83b7\u53d6 html \u4e2d\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"#idText"),"\xa0 \u8fd9\u4e2a p \u5143\u7d20\u6765\u663e\u793a\u81ea\u5df1\u7684 ID\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'const idText = document.getElementById("idText");\n\npeer.on("open", (id) => {\n  idText.textContent = "\u6211\u7684 id \u662f\uff1a" + id;\n});\n')),(0,i.kt)("p",null,"\u8fd9\u65f6\u5728 Live Server \u4e2d\u6253\u5f00 index.html\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u663e\u793a\u51fa\u4e86 ID\uff0c\u7c7b\u4f3c\u4e8e\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"\u6211\u7684 id \u662f\uff1a2573c3ae-ba79-404a-b807-2128856ef3c9\n")),(0,i.kt)("p",null,"\u591a\u6253\u5f00\u51e0\u4e2a\u9875\u9762\uff0c\u53ef\u4ee5\u770b\u5230\u6bcf\u4e2a\u4eba\u7684 ID \u90fd\u4e0d\u540c\u3002"),(0,i.kt)("h2",{id:"\u547c\u53eb\u89c6\u9891\u901a\u8bdd"},"\u547c\u53eb\u89c6\u9891\u901a\u8bdd"),(0,i.kt)("p",null,"\u5728\u6709\u4e86\u7528\u6237 ID \u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u547c\u53eb\u5bf9\u65b9\u4e86\u3002\u8fd9\u91cc\u7684\u903b\u8f91\u662f\uff0c\u7528\u6237\u5728\u8f93\u5165\u6846\u8f93\u5165\u5bf9\u65b9 ID \u4e4b\u540e\uff0c\u70b9\u51fb\u89c6\u9891\u901a\u8bdd\u6309\u94ae\u8fdb\u884c\u547c\u53eb\u3002\u90a3\u4e48\u6211\u4eec\u5e94\u8be5\u5148\u83b7\u53d6\u89c6\u9891\u901a\u8bdd\u6309\u94ae\u5143\u7d20\uff0c\u7136\u540e\u76d1\u542c\u5b83\u7684\u70b9\u51fb\u4e8b\u4ef6\uff0c\u5728\u91cc\u8fb9\u53d1\u8d77\u547c\u53eb\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'const joinBtn = document.getElementById("joinBtn");\n// \u53d1\u8d77\u547c\u53eb\njoinBtn.addEventListener("click", () => {\n  const peerId = peerIdInput.value;\n  console.log("\u6b63\u5728\u8fde\u63a5\uff1a" + peerId);\n\n  navigator.mediaDevices\n    .getUserMedia({ video: true, audio: true })\n    .then((stream) => {\n      const call = peer.call(peerId, stream);\n      call.on("stream", showVideo);\n    });\n});\n')),(0,i.kt)("p",null,"\u5728\u70b9\u51fb\u6309\u94ae\u7684\u65f6\u5019\uff0c\u4e8b\u4ef6\u5904\u7406\u51fd\u6570\u4f5c\u4e86\u5982\u4e0b\u64cd\u4f5c\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u7528\u6237\u8f93\u5165\u7684\u5bf9\u65b9\u7684 ID\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u5f53\u524d\u7528\u6237\u7684\u89c6\u9891\u6d41\uff0c\u7136\u540e\u8c03\u7528 ",(0,i.kt)("inlineCode",{parentName:"li"},"peer.call()"),"\xa0 \u547c\u53eb\u5bf9\u65b9\uff0c ",(0,i.kt)("inlineCode",{parentName:"li"},"peer.call()"),"\xa0 \u9700\u8981\u5bf9\u65b9\u7684 ID \u548c\u81ea\u5df1\u7684\u89c6\u9891\u6d41\u4f5c\u4e3a\u53c2\u6570\uff0c\u7136\u540e\u8fd4\u56de\u4e0e\u547c\u53eb\u6709\u5173\u7684\u5b9e\u4f8b\uff0c\u4fdd\u5b58\u5230 call \u4e2d\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u8fd9\u65f6\u5f53\u524d\u7528\u6237\u5c31\u5f00\u59cb\u7b49\u5f85\u5bf9\u65b9\u5e94\u7b54\u4e86\uff0c\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u8fd9\u91cc\u6ca1\u6709\u505a\u7b49\u5f85\u7684\u6837\u5f0f\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u4e0b\u4e00\u6b65\u76d1\u542c call \u7684 ",(0,i.kt)("strong",{parentName:"li"},"stream"),"\xa0 \u4e8b\u4ef6\uff0c\u8fd9\u4e2a\u4e8b\u4ef6\u4f1a\u5728\u5bf9\u65b9\u5e94\u7b54\u540e\u89e6\u53d1\uff0c\u5b83\u4f1a\u8fd4\u56de\u5bf9\u65b9\u7684\u89c6\u9891\u6d41\u4f5c\u4e3a\u4e8b\u4ef6\u5904\u7406\u51fd\u6570\u7684\u53c2\u6570\uff0c\u7136\u540e\u6211\u4eec\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"li"},"showVideo()"),"\xa0 \u51fd\u6570\u5904\u7406\u5bf9\u65b9\u7684\u89c6\u9891\u6d41\u3002")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"showVideo()"),"\xa0 \u51fd\u6570\u7684\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'const peerVideo = document.getElementById("peerVideo");\n\nfunction showVideo(stream) {\n  myVideo.classList.add("rightTop");\n  peerVideo.srcObject = stream;\n  peerVideo.style.display = "block";\n}\n')),(0,i.kt)("p",null,"\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f\u7b80\u5355\u7684\u628a\u81ea\u5df1\u7684\u89c6\u9891\u79fb\u52a8\u5230\u53f3\u4e0a\u89d2\uff0c\u901a\u8fc7\u4e4b\u524d\u5b9a\u4e49\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},".rightTop"),"\xa0class \u6837\u5f0f\uff0c\u7136\u540e\u628a\u5bf9\u65b9\u7684\u89c6\u9891\u6d41\u653e\u5230 ",(0,i.kt)("inlineCode",{parentName:"p"},"#peerVideo"),"\xa0 \u89c6\u9891\u7ec4\u4ef6\u4e2d\uff0c\u4e4b\u540e\u628a\u5b83\u663e\u793a\u51fa\u6765\uff08\u4e4b\u524d\u8bbe\u7f6e\u7684\u662f ",(0,i.kt)("inlineCode",{parentName:"p"},"display: none"),"\xa0 \u9690\u85cf\uff09\u3002\u73b0\u5728\u56e0\u4e3a\u4e00\u76f4\u662f\u7b49\u5f85\u5bf9\u65b9\u63a5\u542c\uff0c\u6240\u4ee5\u9700\u8981\u6709\u4e00\u4e2a\u5e94\u7b54\u7684\u5904\u7406\u3002"),(0,i.kt)("h2",{id:"\u5e94\u7b54\u89c6\u9891\u901a\u8bdd"},"\u5e94\u7b54\u89c6\u9891\u901a\u8bdd"),(0,i.kt)("p",null,"\u5e94\u7b54\u7684\u5904\u7406\u662f\u76d1\u542c peer \u7684 ",(0,i.kt)("strong",{parentName:"p"},"call"),"\xa0 \u4e8b\u4ef6\uff0c\u7136\u540e\u901a\u8fc7\u4e8b\u4ef6\u53c2\u6570\u4e2d\u4e0e\u547c\u53eb\u6709\u5173\u7684\u5b9e\u4f8b\u6765\u5e94\u7b54\u901a\u8bdd\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'// \u5e94\u7b54\u547c\u53eb\npeer.on("call", (call) => {\n  navigator.mediaDevices\n    .getUserMedia({ video: true, audio: true })\n    .then((stream) => {\n      call.answer(stream);\n      call.on("stream", showVideo);\n    });\n});\n')),(0,i.kt)("p",null,"\u8fd9\u4e00\u6b65\u7684\u4ee3\u7801\u867d\u7136\u5728\u540c\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u4f46\u662f\u5e94\u8be5\u60f3\u8c61\u4e3a\u6536\u5230\u89c6\u9891\u901a\u8bdd\u547c\u53eb\u7684\u5bf9\u65b9\uff0c\u4ee3\u7801\u4f5c\u4e86\u4e0b\u8fb9\u7684\u64cd\u4f5c\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u81ea\u5df1\u7684\u89c6\u9891\u6d41\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u8c03\u7528 ",(0,i.kt)("inlineCode",{parentName:"li"},"answer()"),"\xa0 \u51fd\u6570\u5e94\u7b54\u89c6\u9891\u547c\u53eb\uff0c\u5e76\u628a\u81ea\u5df1\u7684\u89c6\u9891\u6d41\u4f20\u56de\u7ed9\u547c\u53eb\u8005\u3002\u8fd9\u91cc\u662f\u5f53\u6709\u547c\u53eb\u65f6\u76f4\u63a5\u8fdb\u884c\u5e94\u7b54\uff0c\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u6ca1\u6709\u7f16\u5199\u70b9\u51fb\u5e94\u7b54\u6309\u94ae\u76f8\u5173\u7684\u6837\u5f0f\u548c\u4e8b\u4ef6\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u76d1\u542c ",(0,i.kt)("strong",{parentName:"li"}," stream "),"\xa0 \u4e8b\u4ef6\uff0c\u8fd9\u4e00\u6b65\u548c\u4e4b\u524d\u7684\u4e00\u6837\uff0c\u5e94\u7b54\u540e\u8fd9\u4e2a\u4e8b\u4ef6\u5c31\u4f1a\u89e6\u53d1\uff0c\u7136\u540e\u540c\u6837\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"li"},"showVideo()")," \u51fd\u6570\u52a0\u8f7d\u89c6\u9891\u3002")),(0,i.kt)("p",null,"\u597d\u4e86\uff0c\u73b0\u5728\u6253\u5f00\u4e24\u4e2a\u9875\u9762\u8bd5\u8bd5\uff0c\u5728\u5176\u4e2d\u4e00\u4e2a\u9875\u9762\u8f93\u5165\u53e6\u4e00\u4e2a\u9875\u9762\u751f\u6210\u7684 ID\uff0c\u7136\u540e\u70b9\u51fb\u89c6\u9891\u901a\u8bdd\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u53cc\u65b9\u89c6\u9891\u663e\u793a\u51fa\u6765\u4e86\u3002\u5982\u679c\u7528\u7684\u662f\u540c\u4e00\u4e2a\u6444\u50cf\u5934\uff0c\u90a3\u4e48\u663e\u793a\u7684\u753b\u9762\u90fd\u662f\u4e00\u6837\u7684\u3002"),(0,i.kt)("h2",{id:"\u5b9e\u73b0\u6362\u8138"},"\u5b9e\u73b0\u6362\u8138"),(0,i.kt)("p",null,"\u5b9e\u73b0\u6362\u8138\u4e3b\u8981\u662f\u7528\u5230\u4e86 Avatarify \u8fd9\u4e2a AI \u6362\u8138\u5e93\uff0c\u5b83\u662f\u4f7f\u7528 Python \u7f16\u5199\u7684\uff0c\u5229\u7528\u4e86 First-Order Motion Model \u7b97\u6cd5\u6765\u5b9e\u73b0\u6362\u8138\u3002\u6211\u4eec\u8fd9\u91cc\u53ea\u9700\u8981\u6309\u7167\u6b65\u9aa4\u8fdb\u884c\u5b89\u88c5\u5c31\u53ef\u4ee5\u4e86\uff0c\u6b64\u5916\u8fd8\u9700\u8981\u5b89\u88c5\u865a\u62df\u6444\u50cf\u5934\u8f6f\u4ef6\uff0c\u7528\u4e8e\u628a Avatarify \u6362\u8138\u540e\u7684\u6570\u636e\u4f5c\u4e3a\u6444\u50cf\u5934\u89c6\u9891\uff0c\u7136\u540e\u5728\u524d\u7aef\u9875\u9762\u4e2d\u8bbf\u95ee\u8fd9\u4e2a\u865a\u62df\u7684\u6444\u50cf\u5934\u3002\nAvatarify \u7531\u4e8e\u662f\u5bf9\u6444\u50cf\u5934\u7684\u89c6\u9891\u8fdb\u884c\u5b9e\u65f6\u8ba1\u7b97\uff0c\u6240\u4ee5\u5bf9\u663e\u5361\u7684\u8981\u6c42\u975e\u5e38\u9ad8\uff0c\u4e14\u53ea\u652f\u6301\u542f\u7528\u4e86 CUDA \u7684 Nvidia \u663e\u5361\u6765\u8fdb\u884c GPU \u52a0\u901f\uff0c\u5b98\u65b9\u7684\u7edf\u8ba1\u6570\u636e\u662f\u8fd9\u6837\u7684\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"GeForce GTX 1080 Ti: 33 \u5e27/\u79d2"),(0,i.kt)("li",{parentName:"ul"},"GeForce GTX 1070: 15 \u5e27/\u79d2"),(0,i.kt)("li",{parentName:"ul"},"GeForce GTX 950: 9 \u5e27/\u79d2")),(0,i.kt)("p",null,"\u5982\u679c\u914d\u7f6e\u8fbe\u4e0d\u5230\uff0c\u53ef\u4ee5\u4f7f\u7528\u817e\u8baf\u4e91\u6216\u963f\u91cc\u4e91\u7684 GPU \u5b9e\u4f8b\uff0c\u628a\u663e\u5361\u6709\u5173\u7684\u8ba1\u7b97\u4ea4\u7ed9\u8fdc\u7a0b\u670d\u52a1\u5668\u53bb\u8fdb\u884c\uff0c\u672c\u5730\u53ea\u9700\u8981\u5efa\u7acb\u89c6\u9891\u6d41\u5373\u53ef\u3002\u672c\u6587\u5c06\u4e3b\u8981\u4f7f\u7528\u8fd9\u79cd\u65b9\u6cd5\u3002\n\u5982\u679c\u914d\u7f6e\u8fbe\u5230\u4e86\u8981\u6c42\uff0c\u4e5f\u53ef\u4ee5\u5728\u672c\u5730\u5b89\u88c5\u8fd0\u884c\uff0c\u4e0d\u8fc7\u6211\u6ca1\u6709\u8bd5\u8fc7\uff0c\u540e\u8fb9\u7b80\u5355\u7684\u8d34\u4e00\u4e0b\u5b98\u65b9\u5b89\u88c5\u6307\u5bfc\uff08Windows \u4e0b\uff09\uff0c\u4f60\u53ef\u4ee5\u81ea\u5df1\u5c1d\u8bd5\u4e00\u4e0b\u3002\n\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u662f\u5728\u672c\u5730\u8fd0\u884c\u7b97\u6cd5\uff0c\u53ef\u4ee5\u5728 Windows \u548c Linux \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fdb\u884c\uff0c\u6216\u8005\u4e5f\u53ef\u4ee5\u4f7f\u7528 docker \u8fdb\u884c\u90e8\u7f72\uff0c\u4e0d\u8fc7\u53ea\u652f\u6301 linux \u64cd\u4f5c\u7cfb\u7edf\u4e0b\u7684 docker\u3002"),(0,i.kt)("h3",{id:"\u8d2d\u4e70\u670d\u52a1\u5668"},"\u8d2d\u4e70\u670d\u52a1\u5668"),(0,i.kt)("p",null,"\u8fd9\u91cc\u4ee5\u817e\u8baf\u4e91 GPU \u5b9e\u4f8b\u4e3a\u4f8b\uff0c\u4ecb\u7ecd\u4e00\u4e0b\u670d\u52a1\u5668\u7684\u914d\u7f6e\uff0c\u5173\u4e8e\u8ba1\u8d39\u6211\u4eec\u4f1a\u4f7f\u7528\u6309\u91cf\u8ba1\u8d39\uff0c\u5b8c\u6210\u8fd9\u7bc7\u6559\u7a0b\u6240\u7528\u7684\u603b\u4f53\u8d39\u7528\u53ef\u80fd\u5728 30 \u5143\u5de6\u53f3\uff0c\n\u7528\u5b8c\u4e4b\u540e\u4e00\u5b9a\u8981\u8bb0\u5f97",(0,i.kt)("strong",{parentName:"p"},"\u5173\u673a\u6216\u8005\u9500\u6bc1\u6765\u505c\u6b62\u8ba1\u8d39"),"\u3002\u5982\u679c\u662f\u5173\u673a\uff0c\u8bb0\u5f97\u5148\u628a\u5e26\u5bbd\u8c03\u6574\u4e3a 0\uff0c\u505c\u6b62\u5e26\u5bbd\u8ba1\u8d39\uff0c\u7136\u540e\u5173\u673a\u65f6\u9009\u62e9\u5173\u673a\u4e0d\u6536\u8d39\u9009\u9879\u3002\n\u6253\u5f00\u4e0b\u65b9\u94fe\u63a5\uff08\u6216\u590d\u5236 ",(0,i.kt)("a",{parentName:"p",href:"https://curl.qcloud.com/KiCrCXo9"},"https://curl.qcloud.com/KiCrCXo9")," \uff09\uff1a"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://cloud.tencent.com/act/cps/redirect?redirect=1001&cps_key=2c427bf21a8dbca51ee45224ab31c2a9&from=console"},"\u817e\u8baf\u4e91\u670d\u52a1\u5668\u8d2d\u4e70\u94fe\u63a5")),(0,i.kt)("p",null,"\u7136\u540e\u5728\u9009\u62e9\u673a\u578b\u4e2d\u9009\u62e9\u5982\u4e0b\u914d\u7f6e\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u8ba1\u8d39\u6a21\u5f0f\uff1a\u6309\u91cf\u8ba1\u8d39\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u5730\u57df\uff1a\u4e2d\u56fd\u9999\u6e2f\u3002\u8fd9\u91cc\u9009\u62e9\u9999\u6e2f\u5730\u533a\u7684\u539f\u56e0\u662f\u5b89\u88c5 Avatarify \u9700\u8981\u5927\u91cf\u7684\u5883\u5916\u6e90\uff0c\u4f8b\u5982 Github\u3001Docker\u3001Nividia\u3001Python \u7b49\uff0c\u4e14\u6570\u91cf\u591a\uff0c\u4f53\u79ef\u4e5f\u5927\uff08\u6709\u7684 700 \u591a M\uff09\uff0c\u5728\u4eb2\u8eab\u6d4b\u8bd5\u8fc7\u56fd\u5185\u533a\u7684\u4e4b\u540e\uff0c\u53d1\u73b0\u884c\u4e0d\u901a\uff0c\u800c\u9999\u6e2f\u5730\u533a\u56e0\u4e3a\u5ef6\u8fdf\u76f8\u5bf9\u8f83\u4f4e\uff0c\u4e14\u8bbf\u95ee\u5883\u5916\u6e90\u901f\u5ea6\u5feb\uff0c\u6240\u4ee5\u8fd9\u91cc\u9009\u62e9\u4e86\u9999\u6e2f\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u5b9e\u4f8b\uff1a\u9009\u62e9 GPU \u578b\uff0c\u5728\u673a\u578b\u5217\u8868\u4e2d\u9009\u62e9 GPU \u8ba1\u7b97\u578b GN7\uff0c\u8fd9\u4e2a\u662f\u6700\u4fbf\u5b9c\u7684\uff0c7.16 \u5143/\u5c0f\u65f6\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u955c\u50cf\uff1a\u9009\u62e9 Ubuntu 64 \u4f4d 18.04\uff0c\u4e0d\u8981\u9009\u8fc7\u9ad8\u7684\u7248\u672c\u3002\u663e\u5361\u9a71\u52a8\u53ef\u80fd\u652f\u6301\u4e0d\u5b8c\u5584\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u52fe\u9009\u4e0a\u540e\u53f0\u81ea\u52a8\u5b89\u88c5 GPU \u9a71\u52a8\uff0cCUDA \u7248\u672c\u9009\u62e9 10.0.130\uff0ccuDNN \u7248\u672c\u9009\u62e9 7.4.2\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u5e26\u5bbd\u5b9e\u6d4b\u9700\u8981 20M \u8d77\u6b65\uff0c\u5927\u6982 1 \u5143/\u5c0f\u65f6\uff0c\u4e0d\u8fc7\u5728\u5b89\u88c5 Avatarify \u7684\u65f6\u5019\u5e26\u5bbd\u53ef\u4ee5\u5c0f\u4e00\u70b9\uff0c\u540e\u8fb9\u771f\u6b63\u5f00\u542f\u89c6\u9891\u7684\u65f6\u5019\u518d\u628a\u5b83\u6539\u5927\u3002"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u6ce8\u610f\u8fd9\u91cc\u7cfb\u7edf\u76d8\u8d39\u7528\u662f 0.03 \u5143/\u5c0f\u65f6\uff0c\u8fd9\u4e2a\u5728\u5173\u673a\u540e\u4ecd\u7136\u4f1a\u6536\u53d6"),"\u3002")),(0,i.kt)("p",null,"\u5728\u4e0b\u4e00\u6b65\u8bbe\u7f6e\u4e3b\u673a\u4e2d\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u65b0\u5efa\u5b89\u5168\u7ec4\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u767b\u5f55\u65b9\u5f0f\u8fd9\u91cc\u4f7f\u7528\u5bc6\u7801\uff0c\u53ef\u4ee5\u9009\u62e9\u81ea\u884c\u8bbe\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u81ea\u52a8\u751f\u6210\u3002")),(0,i.kt)("p",null,"\u518d\u4e0b\u4e00\u6b65\u786e\u8ba4\u6210\u529f\u540e\u5b8c\u6210\u8d2d\u4e70\uff0c\u7a0d\u540e\u5c31\u53ef\u4ee5\u5728\u63a7\u5236\u53f0\u5b9e\u4f8b\u5217\u8868\u4e2d\u770b\u5230\u521a\u8d2d\u4e70\u7684\u5b9e\u4f8b\u4e86\uff0c\u65b0\u8d2d\u4e70\u7684\u673a\u5668\u53ef\u80fd\u9700\u8981\u7b49 5 \u5206\u949f\u624d\u80fd\u914d\u7f6e\u5b8c\u6210\u3002\u5982\u679c\u8981\u4fee\u6539\u5e26\u5bbd\uff0c\u53ef\u4ee5\u5728\u5217\u8868\u4e2d\u627e\u5230\u5bf9\u5e94\u7684\u5b9e\u4f8b\uff0c\u5728\u6700\u53f3\u4fa7\u64cd\u4f5c\u680f\u91cc\u9009\u62e9\u66f4\u591a->\u8d44\u6e90\u8c03\u6574->\u8c03\u6574\u5e26\u5bbd\uff0c\u8fdb\u884c\u8c03\u6574\u3002\n\u56e0\u4e3a Avatarify \u9700\u8981\u4f7f\u7528 5557 \u548c 5558 \u7aef\u53e3\uff0c\u6211\u4eec\u9700\u8981\u5728\u5b89\u5168\u7ec4\u4e2d\u653e\u884c\u8fd9\u4e24\u4e2a\u7aef\u53e3\u3002\u70b9\u51fb\u5b9e\u4f8b\u540d\u79f0\u8d85\u94fe\u63a5\uff0c\u8fdb\u5165\u5b9e\u4f8b\u8be6\u60c5\u9875\u9762\uff0c\u5728\u4e0a\u65b9\u9009\u9879\u5361\u4e2d\u9009\u62e9 ",(0,i.kt)("strong",{parentName:"p"},"\u5b89\u5168\u7ec4"),"\xa0\uff0c\u5728\u53f3\u4fa7 ",(0,i.kt)("strong",{parentName:"p"},"\u89c4\u5219\u9884\u89c8"),"\xa0 \u4e2d\u7684 ",(0,i.kt)("strong",{parentName:"p"},"\u5165\u7ad9\u89c4\u5219"),"\xa0 \u9009\u9879\u5361\u91cc\uff0c\u70b9\u51fb ",(0,i.kt)("strong",{parentName:"p"},"\u7f16\u8f91\u89c4\u5219"),"\uff0c\u5728\u65b0\u9875\u9762\u91cc\u7684\u5165\u7ad9\u89c4\u5219\u91cc\uff0c\u70b9\u51fb ",(0,i.kt)("strong",{parentName:"p"},"\u6dfb\u52a0\u89c4\u5219\uff0c"),"\u5728\u5bf9\u8bdd\u6846\u91cc\u586b\u5199\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u7c7b\u578b\uff1a\u81ea\u5b9a\u4e49\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u6765\u6e90\uff1aall\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u534f\u8bae\u7aef\u53e3\uff1aTCP:5557,5558"),(0,i.kt)("li",{parentName:"ul"},"\u7b56\u7565\uff1a\u5141\u8bb8\u3002")),(0,i.kt)("p",null,"\u70b9\u51fb\u5b8c\u6210\u5373\u53ef\u3002\u5230\u8fd9\u91cc\u5b9e\u4f8b\u914d\u7f6e\u5c31\u5b8c\u6210\u4e86\uff0c\u7559\u610f\u4e00\u4e0b\u5b9e\u4f8b\u7684\u516c\u7f51 IP \u5730\u5740\uff0c\u7a0d\u540e\u4f7f\u7528 SSH \u767b\u5f55\u65f6\u9700\u8981\u7528\u5230\u5b83\u3002"),(0,i.kt)("h3",{id:"\u90e8\u7f72-avatarify"},"\u90e8\u7f72 Avatarify"),(0,i.kt)("p",null,"\u6211\u4eec\u4f7f\u7528 Docker \u7684\u65b9\u5f0f\u6765\u90e8\u7f72 Avatarify\uff0c\u5148\u767b\u5f55\u5230\u6211\u4eec\u7684 GPU \u5b9e\u4f8b\u4e2d\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u817e\u8baf\u4e91\u63a7\u5236\u53f0\u767b\u5f55\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 ssh \u547d\u4ee4\u6216 putty \u5de5\u5177\u3002\u8fd9\u91cc\u4ee5 ssh \u4e3a\u4f8b\uff0c\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"ssh ubuntu@\u4f60\u7684\u5b9e\u4f8bip\n")),(0,i.kt)("p",null,"\u7136\u540e\u6839\u636e\u63d0\u793a\u8f93\u5165\u5bc6\u7801\uff0c\u7b2c\u4e00\u6b21\u767b\u5f55\u53ef\u80fd\u6709\u4e00\u5927\u6bb5\u82f1\u6587\u63d0\u793a\uff08\u662f\u5426\u4fe1\u4efb\u8bbe\u5907\uff09\uff0c\u76f4\u63a5\u8f93\u5165 yes \u56de\u8f66\u5373\u53ef\u3002"),(0,i.kt)("h4",{id:"\u5b89\u88c5-docker"},"\u5b89\u88c5 Docker"),(0,i.kt)("p",null,"\u767b\u5f55\u8fdb\u53bb\u4e4b\u540e\u5148\u5b89\u88c5 docker\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u7b80\u6613\u7684\u5b89\u88c5\u811a\u672c\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"curl -fsSL https://get.docker.com -o get-docker.sh\nsudo sh get-docker.sh\n")),(0,i.kt)("p",null,"\u4e0d\u8fc7\u5b9e\u6d4b\u9999\u6e2f\u7684\u5b9e\u4f8b\u597d\u50cf\u5e76\u4e0d\u80fd\u8bbf\u95ee\u8fd9\u4e2a\u811a\u672c\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u666e\u901a\u65b9\u5f0f\u5b89\u88c5\uff0c\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u590d\u5236\u7c98\u8d34\u547d\u4ee4\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'# \u7b2c\u4e00\u6b65\nsudo apt-get update\n\n# \u7b2c\u4e8c\u6b65\nsudo apt-get install \\\n    apt-transport-https \\\n    ca-certificates \\\n    curl \\\n    gnupg\n\n# \u7b2c\u4e09\u6b65\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg\n\n# \u7b2c\u56db\u6b65\necho \\\n  "deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \\\n  $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null\n')),(0,i.kt)("p",null,"\u8fd9\u4e9b\u6b65\u9aa4\u90fd\u662f\u5728\u914d\u7f6e Docker \u7684\u5b89\u88c5\u4ed3\u5e93\u6e90\u548c\u5bc6\u94a5\uff0c\u63a5\u4e0b\u6765\u8fd0\u884c\u4e0b\u9762\u4e24\u6761\u547d\u4ee4\u6765\u5b89\u88c5 Docker\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt-get update\nsudo apt-get install docker-ce docker-ce-cli containerd.io\n")),(0,i.kt)("p",null,"\u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\uff0c ",(0,i.kt)("inlineCode",{parentName:"p"},"docker"),"\xa0 \u547d\u4ee4\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u624d\u80fd\u8fd0\u884c\uff0c\u6bcf\u6b21\u90fd\u9700\u8981\u8f93\u5165 ",(0,i.kt)("inlineCode",{parentName:"p"},"sudo"),"\uff0c\u5982\u679c\u8981\u7701\u7565 ",(0,i.kt)("inlineCode",{parentName:"p"},"sudo"),"\xa0\uff0c\u53ef\u4ee5\u628a\u5f53\u524d\u7528\u6237\uff08\u817e\u8baf\u4e91\u9ed8\u8ba4\u4e3a ubuntu\uff09\u6dfb\u52a0\u5230 docker \u7528\u6237\u7ec4\u4e2d\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo usermod -aG docker ubuntu\n")),(0,i.kt)("p",null,"\u4e4b\u540e\u9000\u51fa ssh \u5e76\u91cd\u65b0\u767b\u5f55\u6765\u8ba9\u914d\u7f6e\u751f\u6548\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd0\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u68c0\u67e5 docker \u662f\u5426\u5b89\u88c5\u6210\u529f\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"docker run hello-world\n")),(0,i.kt)("p",null,"\u6709\u6253\u5370\u51fa hello world \u5b57\u6837\u548c\u4e00\u5927\u6bb5\u82f1\u6587\u5c31\u8bf4\u660e\u6210\u529f\u4e86\u3002"),(0,i.kt)("h4",{id:"\u5b89\u88c5-nvidia-docker-tookit"},"\u5b89\u88c5 Nvidia Docker tookit"),(0,i.kt)("p",null,"\u8981\u8ba9 docker \u4f7f\u7528 GPU\uff0c\u9700\u8981\u5b89\u88c5 Nvidia Docker tookit\uff0c\u8fd9\u4e00\u6b65\u4e5f\u5f88\u7b80\u5355\uff0c\u9996\u5148\u8bbe\u7f6e Nvidia \u7684\u4ed3\u5e93\u6e90\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"distribution=$(. /etc/os-release;echo $ID$VERSION_ID) \\\n   && curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add - \\\n   && curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list\n")),(0,i.kt)("p",null,"\u7136\u540e\u5b89\u88c5 tookit \u5e76\u91cd\u542f Docker\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt-get update\nsudo apt-get install -y nvidia-docker2\nsudo systemctl restart docker\n")),(0,i.kt)("p",null,"\u8fd0\u884c\u4e00\u4e2a\u793a\u4f8b container \u68c0\u67e5\u662f\u5426\u5b89\u88c5\u6210\u529f\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo docker run --rm --gpus all nvidia/cuda:11.0-base nvidia-smi\n")),(0,i.kt)("p",null,"\u5982\u679c\u6253\u5370\u51fa\u7c7b\u4f3c\u7684\u5982\u4e0b\u4fe1\u606f\u5c31\u7b97\u6210\u529f\u4e86\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Fri Mar  5 08:47:39 2021\n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 418.126.02   Driver Version: 418.126.02   CUDA Version: 11.0     |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|===============================+======================+======================|\n|   0  Tesla T4            Off  | 00000000:00:08.0 Off |                    0 |\n| N/A   26C    P8     9W /  70W |      0MiB / 15079MiB |      0%      Default |\n+-------------------------------+----------------------+----------------------+\n\n+-----------------------------------------------------------------------------+\n| Processes:                                                       GPU Memory |\n|  GPU       PID   Type   Process name                             Usage      |\n|=============================================================================|\n|  No running processes found                                                 |\n+-----------------------------------------------------------------------------+\n")),(0,i.kt)("h4",{id:"\u6784\u5efa-avatarify-docker-\u955c\u50cf"},"\u6784\u5efa Avatarify Docker \u955c\u50cf"),(0,i.kt)("p",null,"\u9009\u62e9\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u4f7f\u7528 git \u514b\u9686 Avatarify \u4ed3\u5e93\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/alievk/avatarify.git\n")),(0,i.kt)("p",null,"\u8fdb\u5165\u5230\u514b\u9686\u4e0b\u6765\u7684 avatarify \u4ed3\u5e93\u4e2d\uff0c\u4f7f\u7528 docker \u6784\u5efa\u955c\u50cf\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"cd avatarify\ndocker build -t avatarify .\n")),(0,i.kt)("p",null,"\u6784\u5efa\u9700\u8981\u7684\u65f6\u95f4\u6bd4\u8f83\u957f\uff0c\u8010\u5fc3\u7b49\u5f85\u5b8c\u6210\u4e4b\u540e\uff0c\u542f\u52a8\u670d\u52a1\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"bash run.sh --is-worker --docker\n")),(0,i.kt)("p",null,"\u770b\u5230\u6709 5557 \u548c 5558 \u7aef\u53e3\u5c31\u8bf4\u660e\u542f\u52a8\u6210\u529f\u4e86\u3002\u5230\u73b0\u5728\uff0cAvatarify \u7684\u670d\u52a1\u7aef\u914d\u7f6e\u5b8c\u6210\u4e86\uff0c\u4e4b\u540e\u5c31\u662f\u4f7f\u7528\u5ba2\u6237\u7aef\u8c03\u7528\u670d\u52a1\uff0c\u628a\u8ba1\u7b97\u90e8\u5206\u4ea4\u7ed9\u6211\u4eec\u7684 GPU \u5b9e\u4f8b\u3002\u8fd9\u65f6\u5982\u679c\u62c5\u5fc3\u8ba1\u8d39\uff0c\u53ef\u4ee5\u5148\u628a\u5b9e\u4f8b\u5173\u673a\uff0c\u5728\u672c\u5730\u5b89\u88c5\u597d\u5ba2\u6237\u7aef\u540e\u518d\u5f00\u673a\u3002\n\u63a5\u4e0b\u6765\u7684\u6b65\u9aa4\u4ee5 MacOS \u4e3a\u4f8b\uff0cWindows \u7248\u53ef\u4ee5\u76f4\u63a5\u8df3\u5230\u540e\u8fb9\u7684 ",(0,i.kt)("strong",{parentName:"p"},"Windows \u5b89\u88c5\u65b9\u6cd5"),"\xa0 \u5c0f\u8282\u3002"),(0,i.kt)("h3",{id:"\u5b89\u88c5-avatarify-\u5ba2\u6237\u7aef"},"\u5b89\u88c5 Avatarify \u5ba2\u6237\u7aef"),(0,i.kt)("p",null,"\u5728\u672c\u5730\u7535\u8111\u4e0a\uff0c\u9996\u5148\u5b89\u88c5 Miniconda Python 3.8\uff0c\u53ef\u4ee5\u4ece\u8fd9\u91cc\u4e0b\u8f7d\uff1a\n",(0,i.kt)("a",{parentName:"p",href:"https://docs.conda.io/en/latest/miniconda.html#macosx-installers"},"https://docs.conda.io/en/latest/miniconda.html#macosx-installers"),"\n\u6216\u8005\u4f7f\u7528 Homebrew\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"brew install --cask miniconda\n")),(0,i.kt)("p",null,"\u514b\u9686 avatarify \u4ed3\u5e93\u5e76\u8fd0\u884c\u5b89\u88c5\u811a\u672c\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/alievk/avatarify.git\ncd avatarify\nbash scripts/install_mac.sh\n")),(0,i.kt)("p",null,"\u4e0b\u8f7d CamTwist \u865a\u62df\u6444\u50cf\u5934\u8f6f\u4ef6\uff08\u7c7b\u4f3c OBS\uff0c\u4f46\u662f OBS \u7684\u865a\u62df\u6444\u50cf\u5934\u5728 Mac \u4e2d\u8bbf\u95ee\u4e0d\u5230\uff09\u5e76\u5b89\u88c5\uff1a\n",(0,i.kt)("a",{parentName:"p",href:"http://camtwiststudio.com/download"},"http://camtwiststudio.com/download")),(0,i.kt)("h3",{id:"\u542f\u52a8-avatarify-\u5ba2\u6237\u7aef"},"\u542f\u52a8 Avatarify \u5ba2\u6237\u7aef"),(0,i.kt)("p",null,"\u786e\u4fdd\u8fdc\u7a0b GPU \u5b9e\u4f8b\u5df2\u542f\u52a8\uff0c\u4e14\u8fd0\u884c\u4e86 avatarify docker \u955c\u50cf\u76d1\u542c 5557 \u548c 5558 \u7aef\u53e3\uff0c\u7136\u540e\u5728\u672c\u5730\u514b\u9686\u7684 avatarify \u4ed3\u5e93\u4e2d\uff0c\u8fd0\u884c mac \u5ba2\u6237\u7aef\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"./run_mac.sh --is-client --in-addr tcp://server_address:5557 --out-addr tcp://server_address:5558\n")),(0,i.kt)("p",null,"\u8bb0\u5f97\u628a\u4e24\u4e2a ",(0,i.kt)("inlineCode",{parentName:"p"},"server_address"),"\xa0 \u6539\u6210 GPU \u5b9e\u4f8b\u7684\u516c\u7f51 IP\u3002\u670d\u52a1\u7aef\u53ef\u80fd\u9700\u8981\u4e0b\u8f7d\u4e00\u4e9b\u5fc5\u8981\u7684\u6587\u4ef6\uff0c\u6240\u4ee5\u8fde\u63a5\u4f1a\u6162\u4e00\u4e9b\uff0c\u7a0d\u7b49\u542f\u52a8\u6210\u529f\u540e Avatarify \u4f1a\u81ea\u52a8\u6253\u5f00\u6444\u50cf\u5934\u7a97\u53e3\u3002\n\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u63d0\u793a\u8c03\u6574\u597d\u8138\u90e8\u4f4d\u7f6e\uff0c\u8fd9\u91cc\u6211\u4eec\u6700\u597d\u628a\u8138\u653e\u5230\u7ea2\u8272\u77e9\u5f62\u6846\u4e2d\uff0c\u5149\u7ebf\u8981\u5145\u8db3\uff0c\u4e0d\u80fd\u592a\u9ed1\uff0c\u53ef\u4ee5\u4f7f\u7528 W/D \u952e\u7f29\u653e\u753b\u9762\uff0c\u8c03\u6574\u597d\u4e4b\u540e\u6309 X \u952e\u5c31\u53ef\u4ee5\u547c\u51fa\u6362\u8138\u4e4b\u540e\u7684\u9884\u89c8\u89c6\u9891\u7a97\u53e3\uff0c\u5b83\u5c31\u662f\u4f5c\u4e3a\u865a\u62df\u6444\u50cf\u5934\u7684\u89c6\u9891\u6765\u6e90\u3002\nAvatarify \u5185\u7f6e\u4e86 9 \u5f20\u793a\u4f8b\u7684\u4eba\u8138\u7167\u7247\uff0c\u53ef\u4ee5\u6309 1-9 \u952e\u8fdb\u884c\u5207\u6362\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4eba\u8138\u7167\u7247\uff0c\u653e\u5230 Avatarify \u4e2d\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"avatars"),"\xa0 \u6587\u4ef6\u5939\u4e0b\u3002\nAvatarify \u6210\u529f\u663e\u793a\u4e4b\u540e\uff0c\u6253\u5f00 CamTwist \u865a\u62df\u6444\u50cf\u5934\uff0c\u5728\u5de6\u4fa7\u9009\u62e9 Desktop+\uff0c\u7136\u540e\u70b9\u51fb\u5e95\u90e8\u7684 select\uff0c\u7136\u540e\u5728\u53f3\u4fa7\u7684 settings \u4e0b\uff0c\u52fe\u4e0a Confine to Application Window\uff0c\u7136\u540e\u52fe\u4e0a\u4e0b\u65b9\u7684 Select from existing windows\xa0\uff0c\u5728\u4e0b\u62c9\u6846\u4e2d\u9009\u62e9 python (avatarify)\xa0\uff0c\u5982\u679c\u627e\u4e0d\u5230\u53ef\u4ee5\u9000\u51fa CamTwist \u91cd\u65b0\u6253\u5f00\uff0c\u6216\u8005\u591a\u70b9\u51fb\u4e0b\u62c9\u6846\u51e0\u6b21\u8bd5\u8bd5\u3002\u73b0\u5728\u865a\u62df\u6444\u50cf\u5934\u5c31\u51c6\u5907\u597d\u4e86\u3002"),(0,i.kt)("h3",{id:"windows-\u5b89\u88c5\u65b9\u6cd5"},"Windows \u5b89\u88c5\u65b9\u6cd5"),(0,i.kt)("p",null,"\u5728 Windows \u4e0b\u7684\u5b89\u88c5\u65b9\u6cd5\u4e0e MacOS \u7c7b\u4f3c\uff0c\u800c\u4e14\u5982\u679c\u663e\u5361\u914d\u7f6e\u591f\u9ad8\uff0c\u53ef\u4ee5\u7701\u7565\u8d2d\u4e70\u8fdc\u7a0b GPU \u670d\u52a1\u5668\u6b65\u9aa4\u3002"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u9996\u5148\u5b89\u88c5 Minicoda Python 3.8\uff0c\u53ef\u4ee5\u4ece\u8fd9\u91cc\u4e0b\u8f7d\uff1a")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://docs.conda.io/en/latest/miniconda.html#windows-installers"},"https://docs.conda.io/en/latest/miniconda.html#windows-installers")),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"\u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\u6253\u5f00 Anaconda \u547d\u4ee4\u63d0\u793a\u7b26\uff0c\u514b\u9686 avatarify \u4ed3\u5e93\uff0c\u5e76\u8fd0\u884c windows \u64cd\u4f5c\u7cfb\u7edf\u4e0b\u7684\u5b89\u88c5\u811a\u672c\uff1a")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/alievk/avatarify.git\ncd avatarify\nscripts\\install_windows.bat\n")),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},"\u5982\u679c\u8981\u5728\u672c\u5730\u6267\u884c\u6362\u8138\u7b97\u6cd5\uff0c\u90a3\u4e48\u9700\u8981\u4e0b\u8f7d network weights\uff08228 MB\uff09\uff1a")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://openavatarify.s3.amazonaws.com/weights/vox-adv-cpk.pth.tar"},"https://openavatarify.s3.amazonaws.com/weights/vox-adv-cpk.pth.tar"),"\n\u6216\n",(0,i.kt)("a",{parentName:"p",href:"https://yadi.sk/d/M0FWpz2ExBfgAA"},"https://yadi.sk/d/M0FWpz2ExBfgAA"),"\n\u6216\n",(0,i.kt)("a",{parentName:"p",href:"https://drive.google.com/file/d/1coUCdyRXDbpWnEkA99NLNY60mb9dQ_n3/view?usp=sharing"},"https://drive.google.com/file/d/1coUCdyRXDbpWnEkA99NLNY60mb9dQ_n3/view?usp=sharing")),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},"\u4e0b\u8f7d\u5b8c\u6210\u540e\u653e\u5230 avatarify \u7684\u6839\u76ee\u5f55\u4e0b\uff0c\u65e0\u9700\u89e3\u538b\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u8fd0\u884c avatarify \u5ba2\u6237\u7aef\uff0c\u5982\u679c\u662f\u5728\u672c\u5730\u8fd0\u884c\uff0c\u53ef\u4ee5\u4f7f\u7528\uff1a")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"./scripts/run_windows.bat\n")),(0,i.kt)("ol",{start:6},(0,i.kt)("li",{parentName:"ol"},"Windows \u7cfb\u7edf\u4e0b\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fdc\u7a0b GPU \u5b9e\u4f8b\uff0c\u4f7f\u7528\u4e0b\u9762\u7684\u65b9\u5f0f\u542f\u52a8\u5ba2\u6237\u7aef\uff1a")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"./scripts/run_windows.bat --is-client --in-addr tcp://server_address:5557 --out-addr tcp://server_address:5558\n")),(0,i.kt)("ol",{start:7},(0,i.kt)("li",{parentName:"ol"},"\u4e24\u4e2a ",(0,i.kt)("inlineCode",{parentName:"li"},"server_address"),"\xa0 \u9700\u8981\u66ff\u6362\u6210\u8fdc\u7a0b GPU \u5b9e\u4f8b\u7684\u516c\u7f51 IP\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u542f\u52a8\u6210\u529f\u4e4b\u540e\u548c Mac \u7684\u64cd\u4f5c\u4e00\u6837\uff0c\u4f7f\u7528 W/D \u7f29\u653e\u753b\u9762\uff0c\u5b8c\u6210\u4e4b\u540e\u6309 X \u952e\u8c03\u51fa avatarify \u9884\u89c8\u7a97\u53e3\u3002")),(0,i.kt)("p",null,"Windows \u4e0b\u7684\u865a\u62df\u6444\u50cf\u5934\u53ef\u4ee5\u4f7f\u7528 OBS\uff0c\u6700\u65b0\u7248\u7684 OBS 26.1 \u53ca\u4ee5\u4e0a\u5df2\u7ecf\u5185\u7f6e\u4e86\u865a\u62df\u6444\u50cf\u5934\u63d2\u4ef6\u4e86\uff0c\u65e0\u9700\u518d\u5355\u72ec\u5b89\u88c5\u3002"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u4e0b\u8f7d\u5e76\u5b89\u88c5 OBS\uff1a")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://obsproject.com/"},"https://obsproject.com/")),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"\u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\u6253\u5f00 OBS\uff0c\u5728\u5de6\u4e0b\u89d2\u7684 Source\uff08\u6e90\uff09\u9762\u677f\u4e2d\u6dfb\u52a0 Windows Capture\uff0c\u628a\u89c6\u9891\u8f93\u5165\u6e90\u8bbe\u7f6e\u4e3a\u67d0\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\uff0c\u7136\u540e\u9009\u62e9 ","[python.exe]",": avatarify \u7a0b\u5e8f\uff0c\u70b9\u51fb OK\uff0c\u53ef\u4ee5\u8c03\u6574\u4ee5\u4e0b\u5927\u5c0f\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u518d\u5728 Tools\uff08\u5de5\u5177\uff09\u83dc\u5355\u4e2d\u9009\u62e9 VirtualCam\uff08\u865a\u62df\u6444\u50cf\u5934\uff09\uff0c\u9009\u62e9 AutoStart\uff08\u81ea\u52a8\u5f00\u542f\uff09\uff0c\u8bbe\u7f6e Buffered Frames\uff08\u7f13\u51b2\uff09\u4e3a 0\uff0c\u7136\u70b9\u51fb\u5f00\u59cb\u3002\uff08\u5982\u679c Tools \u83dc\u5355\u6ca1\u6709 VirtualCam\uff0c\u770b\u770b\u754c\u9762\u53f3\u4e0b\u89d2\u7684 start recording \u9644\u8fd1\u6709\u6ca1\u6709 start virtual cam\uff09\u3002")),(0,i.kt)("p",null,"\u73b0\u5728\u865a\u62df\u6444\u50cf\u5934\u5c31\u51c6\u5907\u597d\u4e86\u3002"),(0,i.kt)("h3",{id:"\u5b9e\u73b0\u6362\u8138-1"},"\u5b9e\u73b0\u6362\u8138"),(0,i.kt)("p",null,"\u63a5\u4e0b\u6765\u5c31\u662f\u5728\u6211\u4eec\u7684\u89c6\u9891\u901a\u8bdd\u524d\u7aef\u9879\u76ee\u4e2d\uff0c\u4f7f\u7528 CamTwist \u6216 OBS \u63d0\u4f9b\u7684\u865a\u62df\u6444\u50cf\u5934\u4e86\u3002\u6211\u4eec\u9700\u8981\u660e\u786e\u77e5\u9053\u5b83\u4eec\u7684\u8bbe\u5907 ID \u624d\u80fd\u6307\u5b9a\u5177\u4f53\u4f7f\u7528\u54ea\u4e2a\u6444\u50cf\u5934\u3002\n\u9996\u5148\u4f7f\u7528 Live Server \u6253\u5f00\u524d\u7aef\u9879\u76ee\u7684 index.html \u6587\u4ef6\uff0c\u5728\u8c37\u6b4c\u5f00\u53d1\u8005\u5de5\u5177\u7684 console \u4e2d\uff0c\u4f7f\u7528\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\u6253\u5370\u51fa\u89c6\u9891\u8bbe\u5907\u4fe1\u606f\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'navigator.mediaDevices.enumerateDevices().then(function (devices) {\n  devices.forEach(function (device) {\n    if (device.kind === "videoinput") {\n      console.log(device);\n    }\n  });\n});\n')),(0,i.kt)("p",null,"\u8fd9\u6bb5\u4ee3\u7801\u5c31\u662f\u8bbf\u95ee\u6240\u6709\u5a92\u4f53\u8bbe\u5907\uff0c\u7136\u540e\u83b7\u53d6\u5176\u4e2d\u7684\u89c6\u9891\u8bbe\u5907\u5e76\u6253\u5370\u51fa\u6765\uff0c\u4ece\u6253\u5370\u7ed3\u679c\u91cc\u627e\u5230 label \u5305\u542b CamTwist \u6216\u8005 OBS\uff08\u89c6\u64cd\u4f5c\u7cfb\u7edf\u800c\u5b9a\uff09\u7684\u90a3\u4e00\u9879\uff0c\u8bb0\u5f55 deviceId \u5c5e\u6027\u3002\n\u5728 index.js \u6587\u4ef6\u4e2d\uff0c\u4fdd\u5b58 deviceId \u503c\u5230\u4e00\u4e2a\u5e38\u91cf\u4e2d\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'const cameraId =\n  "982947417cf490bae44ffb6a837bddcb813704ee491dd85d9149c45389f5521b";\n')),(0,i.kt)("p",null,"\u5728\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"navigator.mediaDevices.getUserMedia()"),"\xa0 \u83b7\u53d6\u6444\u50cf\u5934\u65f6\uff0c\u9664\u4e86\u53ef\u4ee5\u628a video \u8bbe\u7f6e\u4e3a true \u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u628a\u4ed6\u7684\u503c\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u5bf9\u8c61\uff0c\u7528\u6765\u6307\u5b9a\u66f4\u591a\u7684\u4fe1\u606f\uff0c\u6211\u4eec\u628a\u5b83\u5355\u72ec\u5b9a\u4e49\u51fa\u6765\uff0c\u5728\u91cc\u8fb9\u4f7f\u7528 cameraId \u6307\u5b9a\u8bbf\u95ee\u54ea\u4e2a\u6444\u50cf\u5934\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"const mediaConstrains = {\n  video: {\n    deviceId: {\n      exact: cameraId,\n    },\n  },\n  audio: true,\n};\n")),(0,i.kt)("p",null,"exact \u662f\u7cbe\u786e\u7684\u3001\u53ea\u4f7f\u7528\u6307\u5b9a ID \u7684\u6444\u50cf\u5934\uff0c\u4e0d\u4f1a\u4f7f\u7528\u5176\u4ed6\u5907\u9009\u7684\u3002\n\u7136\u540e\u5728\u83b7\u53d6\u81ea\u5df1\u6444\u50cf\u5934\u8bbe\u5907\u7684\u90e8\u5206\uff0c\u66ff\u6362\u6210\u4e0a\u8fb9\u8fd9\u4e2a\u5bf9\u8c61\u3002\u6216\u8005\u4e3a\u4e86\u65b9\u4fbf\u6d4b\u8bd5\uff0c\u4e5f\u53ef\u4ee5\u628a\u6240\u6709\u7684\u90fd\u66ff\u6362\u6389\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"navigator.mediaDevices.getUserMedia(mediaConstrains).then(/* ... */);\n")),(0,i.kt)("p",null,"\u597d\u4e86\uff0c\u73b0\u5728\u518d\u8bd5\u8bd5\u89c6\u9891\u901a\u8bdd\uff0c\u662f\u4e0d\u662f\u6210\u529f\u7684\u6362\u8138\u4e86\u5462\uff1f\n\u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662f\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a CamTwist \u8f6f\u4ef6\u548c\u771f\u6b63\u7684\u6444\u50cf\u5934\u6709\u51b2\u7a81\uff0c\u9875\u9762\u4f1a\u4e0d\u65f6\u7684\u91cd\u65b0\u5237\u65b0\uff0c\u8fd9\u4e2a\u6682\u65f6\u8fd8\u6ca1\u6709\u6bd4\u8f83\u597d\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5982\u679c\u4f60\u6709\u7cbe\u529b\u7684\u8bdd\u53ef\u4ee5\u7814\u7a76\u4e00\u4e0b\u3002\n\u9644\u4e0a\u672c\u6587\u7684\u6e90\u4ee3\u7801\uff1a\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/zxuqian/code-examples/tree/master/webrtc/video-call-change-face"},"https://github.com/zxuqian/code-examples/tree/master/webrtc/video-call-change-face")),(0,i.kt)("h2",{id:"\u603b\u7ed3"},"\u603b\u7ed3"),(0,i.kt)("p",null,"\u8fd9\u7bc7\u6559\u7a0b\u6240\u7528\u5230\u7684\u6280\u672f\u90fd\u5f88\u7b80\u5355\uff0c\u53ea\u662f\u914d\u7f6e\u6bd4\u8f83\u590d\u6742\uff0c\u672c\u6559\u7a0b\u63d0\u4f9b\u4e86\u6362\u8138\u7684\u57fa\u672c\u6b65\u9aa4\uff0c\u5269\u4e0b\u7684\u53ef\u4ee5\u6839\u636e\u9700\u8981\u7ee7\u7eed\u8fdb\u884c\u5b8c\u5584\u3002\u793a\u4f8b\u4e2d\u5b9e\u73b0\u7684\u7684\u662f\u4e00\u5bf9\u4e00\u7684\u89c6\u9891\u901a\u8bdd\uff0c\u4e0d\u8fc7\u5728\u8fd9\u4e2a\u57fa\u7840\u4e0a\u4e5f\u5b8c\u5168\u53ef\u4ee5\u5b9e\u73b0\u591a\u65b9\u89c6\u9891\u4f1a\u8bae\uff0c\u53ea\u9700\u8981\u8c03\u6574\u4e00\u4e0b\u89c6\u9891\u663e\u793a\u7684\u6837\u5f0f\uff0c\u7136\u540e\u5728\u6709\u65b0\u4eba\u52a0\u8fdb\u6765\u65f6\uff0c\u521b\u5efa\u76f8\u5e94\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"<video />"),"\xa0 \u6807\u7b7e\uff0c\u5e76\u8ffd\u52a0\u5230\u73b0\u6709\u7684\u89c6\u9891\u5217\u8868\u4e2d\u5373\u53ef\u3002\u73b0\u5728\u6211\u4eec\u6765\u56de\u987e\u4e00\u4e0b\u8fc7\u7a0b\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u7f16\u5199\u524d\u7aef HTML/CSS \u9875\u9762\u7ed3\u6784\u548c\u6837\u5f0f\uff0c\u5e76\u5c1d\u8bd5\u52a0\u8f7d\u6444\u50cf\u5934\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u7f16\u5199\u7b80\u5355\u7684\u540e\u53f0\u5e94\u7528\uff0c\u5229\u7528 epxress \u548c peer \u5efa\u7acb\u57fa\u4e8e WebRTC \u7684\u89c6\u9891\u901a\u8bdd\u57fa\u7840\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u524d\u7aef\u5229\u7528 peer.js \u524d\u7aef\u5e93\u8c03\u7528\u540e\u53f0\u751f\u6210\u7528\u6237 ID\uff0c\u5e76\u547c\u53eb\u3001\u5e94\u7b54\u89c6\u9891\u901a\u8bdd\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u914d\u7f6e Avatarify \u6362\u8138\u670d\u52a1\u5668\u7a0b\u5e8f\uff0c\u5229\u7528\u4e91 GPU \u670d\u52a1\u628a\u663e\u5361\u8ba1\u7b97\u76f8\u5173\u90e8\u5206\u8f6c\u79fb\u5230 GPU \u5b9e\u4f8b\u4e2d\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u5b89\u88c5 Avatarify \u5ba2\u6237\u7aef\u7a0b\u5e8f\u548c\u865a\u62df\u6444\u50cf\u5934\u5e94\u7528\uff0c\u628a\u6362\u8138\u540e\u7684\u6570\u636e\u7528\u865a\u62df\u6444\u50cf\u5934\u5c55\u73b0\u51fa\u6765\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u524d\u7aef\u83b7\u53d6\u865a\u62df\u6444\u50cf\u5934 ID\uff0c\u5728\u89c6\u9891\u901a\u8bdd\u7684\u65f6\u5019\u4f7f\u7528\u6b64\u6444\u50cf\u5934\u3002")),(0,i.kt)("p",null,"\u5982\u679c\u6709\u5e2e\u52a9\u8bf7\u70b9\u8d5e\u5e76\u5206\u4eab\uff0c\u6709\u95ee\u9898\u53ef\u4ee5\u8bc4\u8bba\u7559\u8a00\uff0c\u611f\u8c22\u9605\u8bfb\uff01"))}u.isMDXComponent=!0},3506:function(e,t,n){"use strict";t.Z=n.p+"assets/medias/webrtc-avatarify-face-swap-demo-2b84596fe5a574818101731a5b2610ec.mp4"}}]);